2025-11-26 16:53:05.921 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 13927 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-11-26 16:53:05.924 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-26 16:53:05.924 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-26 16:53:06.208 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-26 16:53:06.213 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-26 16:53:06.214 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-26 16:53:06.230 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-26 16:53:06.231 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 288 ms
2025-11-26 16:53:06.245 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-11-26 16:53:06.286 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-11-26 16:53:06.287 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-11-26 16:53:06.287 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-11-26 16:53:06.287 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-11-26 16:53:06.287 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-11-26 16:53:06.350 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-11-26 16:53:06.350 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-11-26 16:53:06.360 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-11-26 16:53:06.361 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-11-26 16:53:06.369 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-11-26 16:53:06.400 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
	{GET [/dlq/test/status]}: getTestStatus()
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/test]}: runTestScenario(TestScenarioRequest)
	{POST [/dlq/test/stop]}: stopTest()
	{GET [/dlq/config]}: getConfig(String)
2025-11-26 16:53:06.405 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-11-26 16:53:06.406 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-11-26 16:53:06.423 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-26 16:53:06.427 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-26 16:53:06.440 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-26 16:53:06.468 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-26 16:53:06.472 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.698 seconds (process running for 0.806)
2025-11-26 16:53:17.088 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-26 16:53:17.088 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-26 16:53:17.088 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-26 16:53:17.088 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-26 16:53:17.088 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-26 16:53:17.089 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@49e2b3c5
2025-11-26 16:53:17.089 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@e829999
2025-11-26 16:53:17.089 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-26 16:53:17.089 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-26 16:53:17.101 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764172397053", parameters={masked}
2025-11-26 16:53:17.101 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:53:17.101 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:53:17.104 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:17.105 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:17.105 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:17.105 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764172397053
2025-11-26 16:53:17.106 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:17.109 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/737/ibppoeij/websocket", parameters={}
2025-11-26 16:53:17.110 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:17.110 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/737/ibppoeij/websocket
2025-11-26 16:53:17.114 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:53:17.114 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:53:17.114 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:53:17.115 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:53:17.128 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 16:53:17.129 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 16:53:17.130 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 3 messages from stream 'test-stream:dlq'
2025-11-26 16:53:17.133 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ibppoeij]
2025-11-26 16:53:17.133 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: ibppoeij
2025-11-26 16:53:17.133 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: ibppoeij (Total active: 1)
2025-11-26 16:53:17.136 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:17.136 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:17.136 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=3, messages=[{id=1764009205380-0, fields={type=order.cancelled, order_id=9782, reason=customer_request}}, {id=1764009193936-0, fields={type=order.cancelled, order_id=2386, reason=customer_request}}, {id=1764009178747-0, fields={type=order.created, order_id=7263, amount=29.48}}], streamName=test-stream:dlq}]
2025-11-26 16:53:17.136 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764009160286-0, fields={type=order.cancelled, order_id=9782, reason=customer_request}}, {id=1764009160188-0, fields={type=order.cancelled, order_id=2386, reason=customer_request}}, {id=1764009160082-0, fields={type=order.created, order_id=7263, amount=29.48}}, {id=1764009160025-0, fields={type=order.created, order_id=6667, amount=28.57}}], streamName=test-stream}]
2025-11-26 16:53:17.147 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:17.147 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:17.148 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:17.148 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:20.906 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-11-26 16:53:20.906 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-11-26 16:53:20.907 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:53:20.907 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:53:20.910 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-11-26 16:53:20.910 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-11-26 16:53:20.910 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-11-26 16:53:20.910 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-11-26 16:53:20.916 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-11-26 16:53:20.916 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-11-26 16:53:20.942 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:20.942 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:20.943 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:20.943 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-11-26 16:53:20.943 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:20.944 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:20.942 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.checkState(WsRemoteEndpointImplBase.java:1249)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.textPartialStart(WsRemoteEndpointImplBase.java:1214)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:222)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:302)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:217)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:146)
	at com.redis.patterns.service.WebSocketEventService.broadcastEvent(WebSocketEventService.java:106)
	at com.redis.patterns.service.DLQMessagingService.deleteStream(DLQMessagingService.java:816)
	at com.redis.patterns.controller.DLQController.deleteStream(DLQController.java:408)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
2025-11-26 16:53:20.946 [http-nio-8080-exec-7] DEBUG o.s.w.s.a.NativeWebSocketSession - Closing StandardWebSocketSession[id=3e300b9f-2590-c061-77bb-3b7cfa9801dc, uri=ws://localhost:8080/api/ws/dlq-events/737/ibppoeij/websocket]
2025-11-26 16:53:20.946 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ibppoeij] closed with CloseStatus[code=1011, reason=null]
2025-11-26 16:53:20.947 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: ibppoeij (Status: CloseStatus[code=1011, reason=null])
2025-11-26 16:53:20.947 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: ibppoeij (Sent 1 messages, Remaining active: 0)
2025-11-26 16:53:20.947 [http-nio-8080-exec-7] ERROR c.r.p.service.WebSocketEventService - Failed to broadcast event
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["{\"eventType\":\"INFO\",\"messageId\":null,\"payload\":null,\"deliveryCount\"...(truncated)'
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:319)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:217)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:146)
	at com.redis.patterns.service.WebSocketEventService.broadcastEvent(WebSocketEventService.java:106)
	at com.redis.patterns.service.DLQMessagingService.deleteStream(DLQMessagingService.java:816)
	at com.redis.patterns.controller.DLQController.deleteStream(DLQController.java:408)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.checkState(WsRemoteEndpointImplBase.java:1249)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.textPartialStart(WsRemoteEndpointImplBase.java:1214)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:222)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:302)
	... 57 common frames omitted
2025-11-26 16:53:20.948 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:20.948 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-11-26 16:53:20.949 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:20.949 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:20.953 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:53:20.953 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:53:20.954 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:20.954 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:20.954 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:53:20.954 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:53:20.954 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:53:20.954 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:53:20.959 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 16:53:20.959 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-11-26 16:53:20.959 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:20.959 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:20.959 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-11-26 16:53:20.959 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 16:53:20.960 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:20.960 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:20.960 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:20.960 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:22.490 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:22.490 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:22.519 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=4140, amount=101.10}}]
2025-11-26 16:53:22.520 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:22.520 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=4140, amount=101.10}
2025-11-26 16:53:22.525 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172402523-0
2025-11-26 16:53:22.525 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:22.525 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172402523-0, streamName=test-stream}]
2025-11-26 16:53:22.525 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:22.525 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:22.580 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:22.580 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:22.581 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=9658, amount=61.94}}]
2025-11-26 16:53:22.582 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:22.582 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=9658, amount=61.94}
2025-11-26 16:53:22.583 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172402582-0
2025-11-26 16:53:22.584 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:22.584 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172402582-0, streamName=test-stream}]
2025-11-26 16:53:22.585 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:22.585 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:22.679 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:22.680 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:22.681 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7307, amount=37.32}}]
2025-11-26 16:53:22.682 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:22.682 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7307, amount=37.32}
2025-11-26 16:53:22.683 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172402682-0
2025-11-26 16:53:22.684 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:22.684 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172402682-0, streamName=test-stream}]
2025-11-26 16:53:22.685 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:22.685 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:22.781 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:22.782 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:22.783 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=2279, amount=30.75}}]
2025-11-26 16:53:22.784 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:22.784 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=2279, amount=30.75}
2025-11-26 16:53:22.788 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172402786-0
2025-11-26 16:53:22.788 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:22.788 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172402786-0, streamName=test-stream}]
2025-11-26 16:53:22.789 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:22.790 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:23.957 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764172403951", parameters={masked}
2025-11-26 16:53:23.958 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:23.958 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764172403951
2025-11-26 16:53:23.959 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:23.963 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/511/jyp01ruw/websocket", parameters={}
2025-11-26 16:53:23.964 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:23.965 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/511/jyp01ruw/websocket
2025-11-26 16:53:23.966 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 16:53:23.968 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=jyp01ruw]
2025-11-26 16:53:23.968 [http-nio-8080-exec-9] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: jyp01ruw
2025-11-26 16:53:23.968 [http-nio-8080-exec-9] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: jyp01ruw (Total active: 1)
2025-11-26 16:53:27.115 [SockJS-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ibppoeij]
2025-11-26 16:53:31.946 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=jyp01ruw] closed with CloseStatus[code=1000, reason=null]
2025-11-26 16:53:31.947 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: jyp01ruw (Status: CloseStatus[code=1000, reason=null])
2025-11-26 16:53:31.947 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: jyp01ruw (Sent 0 messages, Remaining active: 0)
2025-11-26 16:53:31.999 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:53:32.000 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:31.999 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:53:32.004 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:32.005 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:53:32.005 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:53:32.005 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764172411997", parameters={masked}
2025-11-26 16:53:32.002 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:53:32.005 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:53:32.005 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:32.006 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764172411997
2025-11-26 16:53:32.007 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:32.008 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 16:53:32.009 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:32.009 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 16:53:32.009 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172402786-0, fields={type=order.created, order_id=2279, amount=30.75}}, {id=1764172402682-0, fields={type=order.created, order_id=7307, amount=37.32}}, {id=1764172402582-0, fields={type=order.created, order_id=9658, amount=61.94}}, {id=1764172402523-0, fields={type=order.created, order_id=4140, amount=101.10}}], streamName=test-stream}]
2025-11-26 16:53:32.009 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:32.009 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 16:53:32.010 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:32.010 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:32.010 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:32.010 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:32.011 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/669/cjjeq450/websocket", parameters={}
2025-11-26 16:53:32.011 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:32.011 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/669/cjjeq450/websocket
2025-11-26 16:53:32.013 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 16:53:32.013 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=cjjeq450]
2025-11-26 16:53:32.014 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: cjjeq450
2025-11-26 16:53:32.014 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: cjjeq450 (Total active: 1)
2025-11-26 16:53:34.859 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-11-26 16:53:34.859 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-11-26 16:53:34.860 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:53:34.860 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:53:34.860 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-11-26 16:53:34.860 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-11-26 16:53:34.860 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-11-26 16:53:34.860 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-11-26 16:53:34.862 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' does not exist
2025-11-26 16:53:34.862 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-11-26 16:53:34.862 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:34.863 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:34.863 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=Stream does not exist, streamName=test-stream:dlq}]
2025-11-26 16:53:34.863 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:34.863 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:34.863 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:34.863 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-11-26 16:53:34.864 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:34.864 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:34.866 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:53:34.866 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:53:34.866 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:34.866 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:34.866 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:53:34.866 [http-nio-8080-exec-8] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:53:34.866 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:53:34.867 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:53:34.869 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-11-26 16:53:34.869 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 16:53:34.869 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:34.869 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:34.869 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-11-26 16:53:34.869 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 16:53:34.870 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:34.870 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:34.870 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:34.870 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:35.644 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=cjjeq450] closed with CloseStatus[code=1000, reason=null]
2025-11-26 16:53:35.644 [http-nio-8080-exec-9] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: cjjeq450 (Status: CloseStatus[code=1000, reason=null])
2025-11-26 16:53:35.644 [http-nio-8080-exec-9] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: cjjeq450 (Sent 1 messages, Remaining active: 0)
2025-11-26 16:53:35.687 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:53:35.688 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:35.687 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:53:35.689 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:53:35.689 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:53:35.689 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:53:35.690 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:53:35.690 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:53:35.692 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764172415687", parameters={masked}
2025-11-26 16:53:35.693 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:35.693 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764172415687
2025-11-26 16:53:35.694 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:35.697 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-11-26 16:53:35.698 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:35.698 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-11-26 16:53:35.699 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/159/m1cju2hw/websocket", parameters={}
2025-11-26 16:53:35.699 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 16:53:35.699 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:35.700 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:35.700 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:53:35.701 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:35.701 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 16:53:35.701 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/159/m1cju2hw/websocket
2025-11-26 16:53:35.702 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:35.703 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:35.703 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 16:53:35.704 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=m1cju2hw]
2025-11-26 16:53:35.705 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: m1cju2hw
2025-11-26 16:53:35.705 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: m1cju2hw (Total active: 1)
2025-11-26 16:53:37.113 [SockJS-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [jyp01ruw]
2025-11-26 16:53:38.504 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:38.505 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:38.506 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=2873, amount=91.42}}]
2025-11-26 16:53:38.507 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:38.507 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=2873, amount=91.42}
2025-11-26 16:53:38.515 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172418514-0
2025-11-26 16:53:38.517 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:53:38.519 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:38.519 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172418514-0, streamName=test-stream}]
2025-11-26 16:53:38.520 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:38.520 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:38.595 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:38.596 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:38.598 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=3460, amount=106.26}}]
2025-11-26 16:53:38.598 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:38.598 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=3460, amount=106.26}
2025-11-26 16:53:38.601 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172418600-0
2025-11-26 16:53:38.601 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:53:38.602 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:38.603 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172418600-0, streamName=test-stream}]
2025-11-26 16:53:38.603 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:38.603 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:38.694 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:38.695 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:38.696 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=9716, amount=29.28}}]
2025-11-26 16:53:38.697 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:38.697 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=9716, amount=29.28}
2025-11-26 16:53:38.700 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172418699-0
2025-11-26 16:53:38.700 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:53:38.702 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:38.702 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172418699-0, streamName=test-stream}]
2025-11-26 16:53:38.703 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:38.703 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:38.795 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:53:38.796 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:53:38.798 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=8042, amount=90.00}}]
2025-11-26 16:53:38.798 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:53:38.798 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=8042, amount=90.00}
2025-11-26 16:53:38.801 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172418800-0
2025-11-26 16:53:38.802 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:53:38.803 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:38.803 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172418800-0, streamName=test-stream}]
2025-11-26 16:53:38.803 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:38.804 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:42.114 [SockJS-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [cjjeq450]
2025-11-26 16:53:50.177 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/config", parameters={}
2025-11-26 16:53:50.179 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#saveConfig(DLQConfigRequest)
2025-11-26 16:53:50.204 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [DLQConfigRequest(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)]
2025-11-26 16:53:50.223 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Saving DLQ configuration: DLQConfigRequest(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:53:50.223 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQConfigService - Saving DLQ configuration for stream 'test-stream': maxDeliveries=1
2025-11-26 16:53:50.224 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:50.224 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, maxDeliveries=1, message=Configuration saved successfully}]
2025-11-26 16:53:50.224 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:50.224 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:52.904 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:53:52.905 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:53:52.906 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:53:52.907 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:53:52.907 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:53:52.908 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:53:52.909 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:53:52.911 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-11-26 16:53:52.912 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:52.913 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:53:52.914 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-11-26 16:53:52.914 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:52.915 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:53:52.916 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:53:52.921 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 16:53:52.923 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:53:52.927 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172418514-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=2873, amount=91.42}]
2025-11-26 16:53:52.929 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:52.932 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:53:52.932 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172418514-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=2873, amount=91.42}]
2025-11-26 16:53:52.933 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:53:52.934 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Message 1764172418514-0 not acknowledged - will be retried
2025-11-26 16:53:52.934 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:52.934 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172418514-0, message= Message 1764172418514-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:53:52.935 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:52.935 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:53:58.196 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:53:58.197 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:53:58.199 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 16:53:58.199 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 16:53:58.200 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 16:53:58.200 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:53:58.200 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:53:58.204 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:53:58.204 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:53:58.206 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:53:58.207 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:53:58.208 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:53:58.210 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:53:58.211 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:53:58.212 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 16:53:58.212 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:53:58.214 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172418600-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=3460, amount=106.26}]
2025-11-26 16:53:58.214 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:53:58.215 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:53:58.216 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172418600-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=3460, amount=106.26}]
2025-11-26 16:53:58.216 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-11-26 16:53:58.321 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764172418600-0 in stream 'test-stream'
2025-11-26 16:53:58.324 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:53:58.325 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Message 1764172418600-0 acknowledged successfully
2025-11-26 16:53:58.326 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:53:58.326 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172418600-0, message= Message 1764172418600-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:53:58.327 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:53:58.327 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:05.899 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:54:05.900 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:54:05.901 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:54:05.901 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:54:05.901 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:54:05.901 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:54:05.901 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:54:05.905 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:54:05.905 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:54:05.906 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:54:05.906 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:54:05.907 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:54:05.909 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 16:54:05.909 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:54:05.910 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172418699-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9716, amount=29.28}]
2025-11-26 16:54:05.910 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:05.911 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:54:05.911 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172418699-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9716, amount=29.28}]
2025-11-26 16:54:05.911 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:54:05.911 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Message 1764172418699-0 not acknowledged - will be retried
2025-11-26 16:54:05.912 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:05.912 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172418699-0, message= Message 1764172418699-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:54:05.912 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:05.913 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:08.956 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:54:08.959 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:54:08.960 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:54:08.961 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:54:08.961 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:54:08.961 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:54:08.961 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:54:08.964 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:54:08.964 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:54:08.966 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:54:08.966 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:54:08.967 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:54:08.969 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:54:08.970 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:08.971 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 16:54:08.971 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:54:08.972 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172418800-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=8042, amount=90.00}]
2025-11-26 16:54:08.972 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:08.973 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:54:08.973 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172418800-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=8042, amount=90.00}]
2025-11-26 16:54:08.973 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:54:08.973 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Message 1764172418800-0 not acknowledged - will be retried
2025-11-26 16:54:08.974 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:08.975 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172418800-0, message= Message 1764172418800-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:54:08.975 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:08.976 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:12.182 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:54:12.183 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:54:12.184 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 16:54:12.184 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 16:54:12.185 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 16:54:12.185 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:54:12.185 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:54:12.186 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:54:12.186 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:54:12.187 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:54:12.187 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:54:12.188 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=1)
2025-11-26 16:54:12.190 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:54:12.191 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:12.191 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 16:54:12.191 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:54:12.337 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-11-26 16:54:12.338 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:12.339 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-11-26 16:54:12.341 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:12.341 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:20.258 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-11-26 16:54:20.258 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-11-26 16:54:20.261 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:54:20.261 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 16:54:20.264 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-11-26 16:54:20.264 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-11-26 16:54:20.265 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-11-26 16:54:20.265 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-11-26 16:54:20.269 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-11-26 16:54:20.269 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-11-26 16:54:20.269 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:20.269 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:20.271 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:20.271 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-11-26 16:54:20.272 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:20.272 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:20.270 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.checkState(WsRemoteEndpointImplBase.java:1249)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.textPartialStart(WsRemoteEndpointImplBase.java:1214)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:222)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:302)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:217)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:146)
	at com.redis.patterns.service.WebSocketEventService.broadcastEvent(WebSocketEventService.java:106)
	at com.redis.patterns.service.DLQMessagingService.deleteStream(DLQMessagingService.java:816)
	at com.redis.patterns.controller.DLQController.deleteStream(DLQController.java:408)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
2025-11-26 16:54:20.273 [http-nio-8080-exec-6] DEBUG o.s.w.s.a.NativeWebSocketSession - Closing StandardWebSocketSession[id=f661cf48-8c46-1c1d-bae0-5035a38505e3, uri=ws://localhost:8080/api/ws/dlq-events/159/m1cju2hw/websocket]
2025-11-26 16:54:20.273 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=m1cju2hw] closed with CloseStatus[code=1011, reason=null]
2025-11-26 16:54:20.273 [http-nio-8080-exec-6] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: m1cju2hw (Status: CloseStatus[code=1011, reason=null])
2025-11-26 16:54:20.273 [http-nio-8080-exec-6] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: m1cju2hw (Sent 22 messages, Remaining active: 0)
2025-11-26 16:54:20.274 [http-nio-8080-exec-6] ERROR c.r.p.service.WebSocketEventService - Failed to broadcast event
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["{\"eventType\":\"INFO\",\"messageId\":null,\"payload\":null,\"deliveryCount\"...(truncated)'
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:319)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:217)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:146)
	at com.redis.patterns.service.WebSocketEventService.broadcastEvent(WebSocketEventService.java:106)
	at com.redis.patterns.service.DLQMessagingService.deleteStream(DLQMessagingService.java:816)
	at com.redis.patterns.controller.DLQController.deleteStream(DLQController.java:408)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.checkState(WsRemoteEndpointImplBase.java:1249)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$StateMachine.textPartialStart(WsRemoteEndpointImplBase.java:1214)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:222)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:48)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:217)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:108)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:228)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:302)
	... 57 common frames omitted
2025-11-26 16:54:20.276 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:20.276 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-11-26 16:54:20.278 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:20.278 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:20.281 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 16:54:20.281 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 16:54:20.281 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:54:20.281 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 16:54:20.282 [http-nio-8080-exec-9] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 16:54:20.282 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 16:54:20.283 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 16:54:20.283 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 16:54:20.285 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-11-26 16:54:20.285 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 16:54:20.286 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:20.286 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:20.286 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-11-26 16:54:20.287 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 16:54:20.287 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:20.287 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:20.287 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:20.288 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:22.999 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/config", parameters={}
2025-11-26 16:54:22.999 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#saveConfig(DLQConfigRequest)
2025-11-26 16:54:23.001 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [DLQConfigRequest(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)]
2025-11-26 16:54:23.002 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Saving DLQ configuration: DLQConfigRequest(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 16:54:23.002 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQConfigService - Saving DLQ configuration for stream 'test-stream': maxDeliveries=2
2025-11-26 16:54:23.003 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:23.003 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, maxDeliveries=2, message=Configuration saved successfully}]
2025-11-26 16:54:23.004 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:23.004 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:23.278 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764172463275", parameters={masked}
2025-11-26 16:54:23.278 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:54:23.279 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764172463275
2025-11-26 16:54:23.280 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:23.294 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/296/zbcaa1gp/websocket", parameters={}
2025-11-26 16:54:23.294 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@de81be1
2025-11-26 16:54:23.295 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/296/zbcaa1gp/websocket
2025-11-26 16:54:23.297 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 16:54:23.298 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zbcaa1gp]
2025-11-26 16:54:23.298 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: zbcaa1gp
2025-11-26 16:54:23.298 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: zbcaa1gp (Total active: 1)
2025-11-26 16:54:26.186 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:54:26.187 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:54:26.188 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=2272, reason=out_of_stock}}]
2025-11-26 16:54:26.188 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:54:26.188 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=2272, reason=out_of_stock}
2025-11-26 16:54:26.191 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172466189-0
2025-11-26 16:54:26.191 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:26.192 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:26.193 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172466189-0, streamName=test-stream}]
2025-11-26 16:54:26.193 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:26.193 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:26.282 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:54:26.283 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:54:26.284 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=2645, reason=customer_request}}]
2025-11-26 16:54:26.284 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:54:26.284 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=2645, reason=customer_request}
2025-11-26 16:54:26.286 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172466284-0
2025-11-26 16:54:26.286 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:26.288 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:26.288 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172466284-0, streamName=test-stream}]
2025-11-26 16:54:26.288 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:26.288 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:26.382 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:54:26.383 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:54:26.385 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=5131, amount=49.23}}]
2025-11-26 16:54:26.385 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:54:26.385 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=5131, amount=49.23}
2025-11-26 16:54:26.388 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172466387-0
2025-11-26 16:54:26.388 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:26.389 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:26.390 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172466387-0, streamName=test-stream}]
2025-11-26 16:54:26.390 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:26.391 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:26.485 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 16:54:26.485 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 16:54:26.486 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7085, amount=59.08}}]
2025-11-26 16:54:26.487 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 16:54:26.487 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7085, amount=59.08}
2025-11-26 16:54:26.488 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764172466487-0
2025-11-26 16:54:26.488 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:54:26.489 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:26.489 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764172466487-0, streamName=test-stream}]
2025-11-26 16:54:26.489 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:26.490 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:54:27.117 [SockJS-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [m1cju2hw]
2025-11-26 16:54:29.595 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:54:29.596 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:54:29.598 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 16:54:29.599 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 16:54:29.599 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 16:54:29.600 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:54:29.600 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:54:29.607 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-11-26 16:54:29.607 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:29.608 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:54:29.610 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-11-26 16:54:29.610 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:29.610 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:54:29.612 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 16:54:29.614 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 16:54:29.614 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:54:29.616 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172466189-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}]
2025-11-26 16:54:29.617 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:54:29.618 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:54:29.618 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466189-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}]
2025-11-26 16:54:29.619 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-11-26 16:54:29.723 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764172466189-0 in stream 'test-stream'
2025-11-26 16:54:29.726 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:54:29.727 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message 1764172466189-0 acknowledged successfully
2025-11-26 16:54:29.728 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:54:29.728 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172466189-0, message= Message 1764172466189-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:54:29.729 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:54:29.729 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:55:54.911 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:55:54.915 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:55:54.920 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:55:54.921 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:55:54.922 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:55:54.922 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:55:54.922 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:55:54.926 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:55:54.927 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:55:54.929 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:55:54.929 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:55:54.930 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 16:55:54.935 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 16:55:54.935 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:55:54.937 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172466284-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2645, reason=customer_request}]
2025-11-26 16:55:54.938 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:55:54.939 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:55:54.939 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466284-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2645, reason=customer_request}]
2025-11-26 16:55:54.940 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:55:54.941 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Message 1764172466284-0 not acknowledged - will be retried
2025-11-26 16:55:54.942 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:55:54.942 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172466284-0, message= Message 1764172466284-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:55:54.943 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:55:54.944 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:55:57.832 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:55:57.833 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:55:57.833 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:55:57.834 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:55:57.834 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:55:57.834 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:55:57.834 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:55:57.836 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:55:57.839 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:55:57.841 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:55:57.845 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:55:57.847 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 16:55:57.851 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 16:55:57.852 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 16:55:57.858 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764172466284-0, deliveryCount=2, retry=true, fields={type=order.cancelled, order_id=2645, reason=customer_request}]
2025-11-26 16:55:57.858 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 16:55:57.858 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466284-0, deliveryCount=2, retry=true, fields={type=order.cancelled, order_id=2645, reason=customer_request}]
2025-11-26 16:55:57.859 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:55:57.859 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Message 1764172466284-0 not acknowledged - will be retried
2025-11-26 16:55:57.860 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:55:57.860 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764172466284-0, message= Message 1764172466284-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-11-26 16:55:57.861 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:55:57.861 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 16:56:03.431 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 16:56:03.432 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 16:56:03.433 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 16:56:03.434 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 16:56:03.434 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 16:56:03.434 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 16:56:03.434 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 16:56:03.437 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 16:56:03.438 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 16:56:03.439 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 16:56:03.440 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 16:56:03.442 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 16:56:03.445 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 16:56:03.446 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 16:56:03.446 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 16:56:03.446 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 16:56:03.448 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172466387-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5131, amount=49.23}]
2025-11-26 16:56:03.448 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 16:56:03.448 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 16:56:03.449 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466387-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5131, amount=49.23}]
2025-11-26 16:56:03.449 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 16:56:03.450 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Message 1764172466387-0 not acknowledged - will be retried
2025-11-26 16:56:03.450 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 16:56:03.451 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172466387-0, message= Message 1764172466387-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 16:56:03.452 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 16:56:03.452 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:22:11.240 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:22:11.244 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:22:11.251 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 17:22:11.254 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 17:22:11.256 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 17:22:11.256 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:22:11.256 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:22:11.270 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:22:11.270 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:22:11.274 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:22:11.274 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:22:11.277 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:22:11.280 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 17:22:11.280 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 17:22:11.286 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764172466387-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5131, amount=49.23}]
2025-11-26 17:22:11.287 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 17:22:11.287 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466387-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5131, amount=49.23}]
2025-11-26 17:22:11.288 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-11-26 17:22:11.395 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764172466387-0 in stream 'test-stream'
2025-11-26 17:22:11.399 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:22:11.399 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message 1764172466387-0 acknowledged successfully
2025-11-26 17:22:11.400 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:22:11.400 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764172466387-0, message= Message 1764172466387-0 processed successfully (deliveryCount: 2), deliveryCount=2}]
2025-11-26 17:22:11.405 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:22:11.406 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:22:12.751 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:22:12.752 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:22:12.752 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:22:12.752 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:22:12.752 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:22:12.753 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:22:12.753 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:22:12.754 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:22:12.754 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:22:12.756 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:22:12.756 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:22:12.756 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:22:12.758 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 17:22:12.758 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:22:12.761 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764172466487-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7085, amount=59.08}]
2025-11-26 17:22:12.761 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:22:12.762 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 17:22:12.762 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466487-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7085, amount=59.08}]
2025-11-26 17:22:12.762 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:22:12.763 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Message 1764172466487-0 not acknowledged - will be retried
2025-11-26 17:22:12.763 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:22:12.763 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764172466487-0, message= Message 1764172466487-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 17:22:12.765 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:22:12.765 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:22:15.670 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:22:15.670 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:22:15.672 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:22:15.672 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:22:15.672 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:22:15.672 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:22:15.672 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:22:15.674 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:22:15.674 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:22:15.675 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:22:15.675 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:22:15.675 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:22:15.677 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 17:22:15.677 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 17:22:15.677 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764172466487-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=7085, amount=59.08}]
2025-11-26 17:22:15.677 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 17:22:15.678 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764172466487-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=7085, amount=59.08}]
2025-11-26 17:22:15.678 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:22:15.678 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Message 1764172466487-0 not acknowledged - will be retried
2025-11-26 17:22:15.679 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:22:15.679 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764172466487-0, message= Message 1764172466487-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-11-26 17:22:15.680 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:22:15.680 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:22:18.508 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:22:18.509 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:22:18.512 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:22:18.512 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:22:18.512 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:22:18.513 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:22:18.513 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:22:18.515 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:22:18.515 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:22:18.518 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:22:18.518 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:22:18.519 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:22:18.521 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:22:18.522 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:22:18.522 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 17:22:18.523 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:22:18.660 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-11-26 17:22:18.661 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:22:18.661 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-11-26 17:22:18.662 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:22:18.662 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:25:53.765 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:25:53.765 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:25:53.770 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:25:53.770 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:25:53.773 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:25:53.773 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:25:53.773 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:25:53.773 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:25:53.776 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:25:53.776 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:25:53.783 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:25:53.783 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:25:53.783 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:25:53.783 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:25:53.800 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:25:53.800 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:25:53.802 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:25:53.802 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:26:35.573 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:26:35.574 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:26:35.576 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:26:35.576 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:26:35.587 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:26:35.587 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:26:35.588 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:26:35.588 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:26:35.594 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:26:35.594 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:26:35.611 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:26:35.611 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:26:35.619 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:26:35.619 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:26:35.627 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:26:35.627 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:26:35.629 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:26:35.629 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:28:56.254 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:28:56.254 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:28:56.260 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:28:56.260 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:28:56.263 [http-nio-8080-exec-8] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:28:56.263 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:28:56.263 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:28:56.263 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:28:56.264 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:28:56.264 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:28:56.266 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:28:56.266 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:28:56.266 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:28:56.266 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:28:56.268 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:28:56.268 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:28:56.268 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:28:56.268 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:09.873 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:30:09.873 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:30:09.876 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:09.876 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:09.885 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:30:09.885 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:30:09.885 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:30:09.885 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:30:09.891 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:30:09.891 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:30:09.899 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:09.899 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:09.900 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:30:09.900 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:30:09.911 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:09.911 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:09.914 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:09.914 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:30.336 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-26 17:30:32.350 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-26 17:30:32.367 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=zbcaa1gp]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-11-26 17:30:32.369 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session zbcaa1gp
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-11-26 17:30:32.369 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: zbcaa1gp (Sent 23 messages, Remaining active: 0)
2025-11-26 17:30:32.370 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zbcaa1gp] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-11-26 17:30:32.370 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: zbcaa1gp (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-11-26 17:30:32.370 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: zbcaa1gp (Sent null messages, Remaining active: 0)
2025-11-26 17:30:38.296 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 29286 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-11-26 17:30:38.297 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-26 17:30:38.297 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-26 17:30:38.574 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-26 17:30:38.579 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-26 17:30:38.579 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-26 17:30:38.594 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-11-26 17:30:38.594 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 280 ms
2025-11-26 17:30:38.608 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-11-26 17:30:38.645 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-11-26 17:30:38.645 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-11-26 17:30:38.645 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-11-26 17:30:38.646 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-11-26 17:30:38.646 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-11-26 17:30:38.694 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-11-26 17:30:38.695 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-11-26 17:30:38.705 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-11-26 17:30:38.707 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-11-26 17:30:38.715 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-11-26 17:30:38.748 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/test]}: runTestScenario(TestScenarioRequest)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{GET [/dlq/config]}: getConfig(String)
2025-11-26 17:30:38.752 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-11-26 17:30:38.753 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 14 mappings in 'requestMappingHandlerMapping'
2025-11-26 17:30:38.765 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-11-26 17:30:38.770 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-11-26 17:30:38.781 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-11-26 17:30:38.808 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-11-26 17:30:38.811 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.654 seconds (process running for 0.75)
2025-11-26 17:30:41.425 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-26 17:30:41.425 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-26 17:30:41.425 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-11-26 17:30:41.425 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-11-26 17:30:41.425 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-11-26 17:30:41.426 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@7f323b3a
2025-11-26 17:30:41.426 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@27e2287c
2025-11-26 17:30:41.427 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-11-26 17:30:41.427 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-26 17:30:41.440 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764174641374", parameters={masked}
2025-11-26 17:30:41.442 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:41.444 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764174641374
2025-11-26 17:30:41.445 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:42.197 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/ws/dlq-events/153/ud24ab3k/xhr_streaming?t=1764174642194", parameters={masked}
2025-11-26 17:30:42.198 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:42.199 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: POST http://localhost:8080/api/ws/dlq-events/153/ud24ab3k/xhr_streaming?t=1764174642194
2025-11-26 17:30:42.202 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.XhrStreamingTransportHandler - POST http://localhost:8080/api/ws/dlq-events/153/ud24ab3k/xhr_streaming?t=1764174642194
2025-11-26 17:30:42.205 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New XhrStreamingSockJsSession[id=ud24ab3k]
2025-11-26 17:30:42.206 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: ud24ab3k
2025-11-26 17:30:42.206 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: ud24ab3k (Total active: 1)
2025-11-26 17:30:42.209 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:46.684 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:30:46.686 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:30:46.688 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764174646678", parameters={masked}
2025-11-26 17:30:46.690 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:46.690 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:46.691 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764174646678
2025-11-26 17:30:46.691 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:46.690 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:46.700 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/483/caxdedx3/websocket", parameters={}
2025-11-26 17:30:46.702 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:46.703 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/483/caxdedx3/websocket
2025-11-26 17:30:46.706 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:30:46.706 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:30:46.707 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:30:46.707 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:30:46.715 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:30:46.715 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:30:46.718 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 17:30:46.722 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:46.722 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=caxdedx3]
2025-11-26 17:30:46.722 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:46.723 [http-nio-8080-exec-6] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: caxdedx3
2025-11-26 17:30:46.723 [http-nio-8080-exec-6] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: caxdedx3 (Total active: 2)
2025-11-26 17:30:46.723 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:30:46.723 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:30:46.729 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:46.729 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:46.729 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:46.730 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:48.592 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=caxdedx3] closed with CloseStatus[code=1000, reason=null]
2025-11-26 17:30:48.593 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: caxdedx3 (Status: CloseStatus[code=1000, reason=null])
2025-11-26 17:30:48.593 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: caxdedx3 (Sent 0 messages, Remaining active: 1)
2025-11-26 17:30:48.641 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:30:48.641 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:48.642 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764174648636", parameters={masked}
2025-11-26 17:30:48.641 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:30:48.643 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:48.643 [http-nio-8080-exec-8] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:30:48.643 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:30:48.643 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:30:48.644 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:48.644 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764174648636
2025-11-26 17:30:48.644 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:30:48.645 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:48.652 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Read 2 messages from stream 'test-stream:dlq'
2025-11-26 17:30:48.652 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/338/1rk5aer0/websocket", parameters={}
2025-11-26 17:30:48.653 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-11-26 17:30:48.653 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:48.653 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@310ed6b4
2025-11-26 17:30:48.653 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=2, messages=[{id=1764174138520-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172563443-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}], streamName=test-stream:dlq}]
2025-11-26 17:30:48.653 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:48.653 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/338/1rk5aer0/websocket
2025-11-26 17:30:48.653 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764172466487-0, fields={type=order.created, order_id=7085, amount=59.08}}, {id=1764172466387-0, fields={type=order.created, order_id=5131, amount=49.23}}, {id=1764172466284-0, fields={type=order.cancelled, order_id=2645, reason=customer_request}}, {id=1764172466189-0, fields={type=order.cancelled, order_id=2272, reason=out_of_stock}}], streamName=test-stream}]
2025-11-26 17:30:48.653 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:48.654 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:48.655 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:48.655 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:48.655 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-11-26 17:30:48.656 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=1rk5aer0]
2025-11-26 17:30:48.656 [http-nio-8080-exec-1] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: 1rk5aer0
2025-11-26 17:30:48.656 [http-nio-8080-exec-1] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: 1rk5aer0 (Total active: 2)
2025-11-26 17:30:50.731 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-11-26 17:30:50.731 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 17:30:50.732 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-11-26 17:30:50.732 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-11-26 17:30:50.733 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-11-26 17:30:50.733 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-11-26 17:30:50.733 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-11-26 17:30:50.733 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-11-26 17:30:50.738 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-11-26 17:30:50.738 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-11-26 17:30:50.771 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 2 sessions: INFO
2025-11-26 17:30:50.771 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 2 sessions: INFO
2025-11-26 17:30:50.772 [http-nio-8080-exec-5] DEBUG o.s.w.s.sockjs.DisconnectedClient - Looks like the client has gone away: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe (For a full stack trace, set the log category 'org.apache.commons.logging.LogAdapter$Slf4jLocationAwareLog@329ac50a' to TRACE level.)
2025-11-26 17:30:50.773 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.XhrStreamingTransportHandler$XhrStreamingSockJsSession - Closing SockJS session ud24ab3k with CloseStatus[code=1011, reason=null]
2025-11-26 17:30:50.773 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - XhrStreamingSockJsSession[id=ud24ab3k] closed with CloseStatus[code=1011, reason=null]
2025-11-26 17:30:50.773 [http-nio-8080-exec-5] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: ud24ab3k (Status: CloseStatus[code=1011, reason=null])
2025-11-26 17:30:50.773 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:50.773 [http-nio-8080-exec-5] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: ud24ab3k (Sent 1 messages, Remaining active: 1)
2025-11-26 17:30:50.773 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-11-26 17:30:50.774 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:50.774 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:50.776 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - "INCLUDE" dispatch for POST "/api/error?t=1764174642194", parameters={masked}
2025-11-26 17:30:50.773 [http-nio-8080-exec-5] ERROR c.r.p.service.WebSocketEventService - Failed to broadcast event
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["{\"eventType\":\"INFO\",\"messageId\":null,\"payload\":null,\"deliveryCount\"...(truncated)'
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:319)
	at org.springframework.web.socket.sockjs.transport.session.StreamingSockJsSession.flushCache(StreamingSockJsSession.java:75)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.sendMessageInternal(AbstractHttpSockJsSession.java:308)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:146)
	at com.redis.patterns.service.WebSocketEventService.broadcastEvent(WebSocketEventService.java:106)
	at com.redis.patterns.service.DLQMessagingService.deleteStream(DLQMessagingService.java:791)
	at com.redis.patterns.controller.DLQController.deleteStream(DLQController.java:375)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doDelete(FrameworkServlet.java:936)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:596)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: org.apache.catalina.connector.ClientAbortException: java.io.IOException: Broken pipe
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:302)
	at org.apache.catalina.connector.OutputBuffer.flush(OutputBuffer.java:264)
	at org.apache.catalina.connector.Response.flushBuffer(Response.java:466)
	at org.apache.catalina.connector.ResponseFacade.flushBuffer(ResponseFacade.java:253)
	at org.springframework.http.server.ServletServerHttpResponse.flush(ServletServerHttpResponse.java:105)
	at org.springframework.web.socket.sockjs.transport.session.AbstractHttpSockJsSession.writeFrameInternal(AbstractHttpSockJsSession.java:361)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:302)
	... 58 common frames omitted
Caused by: java.io.IOException: Broken pipe
	at java.base/sun.nio.ch.SocketDispatcher.write0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:65)
	at java.base/sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:137)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:102)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:58)
	at java.base/sun.nio.ch.SocketChannelImpl.implWrite(SocketChannelImpl.java:562)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:614)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:125)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.doWrite(NioEndpoint.java:1413)
	at org.apache.tomcat.util.net.SocketWrapperBase.doWrite(SocketWrapperBase.java:732)
	at org.apache.tomcat.util.net.SocketWrapperBase.flushBlocking(SocketWrapperBase.java:698)
	at org.apache.tomcat.util.net.SocketWrapperBase.flush(SocketWrapperBase.java:683)
	at org.apache.coyote.http11.Http11OutputBuffer$SocketOutputBuffer.flush(Http11OutputBuffer.java:574)
	at org.apache.coyote.http11.filters.ChunkedOutputFilter.flush(ChunkedOutputFilter.java:154)
	at org.apache.coyote.http11.Http11OutputBuffer.flush(Http11OutputBuffer.java:216)
	at org.apache.coyote.http11.Http11Processor.flush(Http11Processor.java:1273)
	at org.apache.coyote.AbstractProcessor.action(AbstractProcessor.java:408)
	at org.apache.coyote.Response.action(Response.java:201)
	at org.apache.catalina.connector.OutputBuffer.doFlush(OutputBuffer.java:298)
	... 64 common frames omitted
2025-11-26 17:30:50.777 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:50.777 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-11-26 17:30:50.778 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:50.778 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 2 matching mappings: [{ [/error]}, { [/error], produces [text/html]}]
2025-11-26 17:30:50.778 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:50.778 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController#error(HttpServletRequest)
2025-11-26 17:30:50.780 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Found 'Content-Type:application/javascript;charset=UTF-8' in response
2025-11-26 17:30:50.781 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-11-26 17:30:50.781 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-11-26 17:30:50.781 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:50.781 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-11-26 17:30:50.781 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-11-26 17:30:50.781 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-11-26 17:30:50.781 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-11-26 17:30:50.781 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-11-26 17:30:50.782 [http-nio-8080-exec-6] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Ignoring exception, response committed already: org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class java.util.LinkedHashMap] with preset Content-Type 'application/javascript;charset=UTF-8'
2025-11-26 17:30:50.782 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-11-26 17:30:50.782 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-11-26 17:30:50.782 [http-nio-8080-exec-6] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.http.converter.HttpMessageNotWritableException: No converter for [class java.util.LinkedHashMap] with preset Content-Type 'application/javascript;charset=UTF-8']
2025-11-26 17:30:50.782 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:50.782 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:50.783 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-11-26 17:30:50.783 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-11-26 17:30:50.783 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:50.783 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:50.783 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:50.783 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:50.783 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Exiting from "INCLUDE" dispatch, status 200
2025-11-26 17:30:57.205 [SockJS-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [caxdedx3, ud24ab3k]
2025-11-26 17:30:57.490 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 17:30:57.491 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 17:30:57.521 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=1762, amount=19.63}}]
2025-11-26 17:30:57.522 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 17:30:57.522 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=1762, amount=19.63}
2025-11-26 17:30:57.525 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764174657524-0
2025-11-26 17:30:57.526 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:30:57.526 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:57.526 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764174657524-0, streamName=test-stream}]
2025-11-26 17:30:57.526 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:57.527 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:57.580 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 17:30:57.581 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 17:30:57.582 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=5827, amount=64.76}}]
2025-11-26 17:30:57.582 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 17:30:57.582 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=5827, amount=64.76}
2025-11-26 17:30:57.584 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764174657583-0
2025-11-26 17:30:57.585 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:30:57.586 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:57.587 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764174657583-0, streamName=test-stream}]
2025-11-26 17:30:57.587 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:57.587 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:57.680 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 17:30:57.681 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 17:30:57.682 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=5030, amount=40.50}}]
2025-11-26 17:30:57.682 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 17:30:57.682 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=5030, amount=40.50}
2025-11-26 17:30:57.685 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764174657684-0
2025-11-26 17:30:57.686 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:30:57.687 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:57.687 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764174657684-0, streamName=test-stream}]
2025-11-26 17:30:57.688 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:57.689 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:30:57.783 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-11-26 17:30:57.784 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-11-26 17:30:57.785 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7819, amount=53.64}}]
2025-11-26 17:30:57.785 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-11-26 17:30:57.785 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7819, amount=53.64}
2025-11-26 17:30:57.789 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764174657788-0
2025-11-26 17:30:57.789 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:30:57.791 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:30:57.792 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764174657788-0, streamName=test-stream}]
2025-11-26 17:30:57.796 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:30:57.796 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:02.615 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:02.615 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:02.616 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 17:31:02.617 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 17:31:02.617 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 17:31:02.619 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:02.619 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:02.622 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-11-26 17:31:02.623 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:02.624 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:02.626 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-11-26 17:31:02.627 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:02.628 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:02.630 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:02.637 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:02.640 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:31:02.644 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764174657524-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1762, amount=19.63}]
2025-11-26 17:31:02.644 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:02.646 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 17:31:02.646 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657524-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1762, amount=19.63}]
2025-11-26 17:31:02.647 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-11-26 17:31:02.750 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764174657524-0 in stream 'test-stream'
2025-11-26 17:31:02.754 [http-nio-8080-exec-2] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:31:02.754 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message 1764174657524-0 acknowledged successfully
2025-11-26 17:31:02.755 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:02.755 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764174657524-0, message= Message 1764174657524-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-11-26 17:31:02.757 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:02.757 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:05.102 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:05.102 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:05.104 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:05.104 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:05.104 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:05.104 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:05.104 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:05.106 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:05.106 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:05.107 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:05.107 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:05.108 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:05.109 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:05.109 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:31:05.109 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764174657583-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5827, amount=64.76}]
2025-11-26 17:31:05.110 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:05.110 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 17:31:05.110 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657583-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5827, amount=64.76}]
2025-11-26 17:31:05.110 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:31:05.111 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Message 1764174657583-0 not acknowledged - will be retried
2025-11-26 17:31:05.111 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:05.112 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764174657583-0, message= Message 1764174657583-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 17:31:05.113 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:05.113 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:09.946 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:09.948 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:09.949 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:09.950 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:09.950 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:09.950 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:09.950 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:09.953 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:09.954 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:09.956 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:09.956 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:09.957 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:09.959 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:09.960 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 17:31:09.964 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764174657583-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5827, amount=64.76}]
2025-11-26 17:31:09.964 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 17:31:09.965 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657583-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5827, amount=64.76}]
2025-11-26 17:31:09.965 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:31:09.966 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Message 1764174657583-0 not acknowledged - will be retried
2025-11-26 17:31:09.967 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:09.967 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764174657583-0, message= Message 1764174657583-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-11-26 17:31:09.969 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:09.969 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:14.637 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:14.641 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:14.645 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:14.646 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:14.647 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:14.647 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:14.647 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:14.652 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:14.652 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:14.653 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:14.653 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:14.654 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:14.660 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:31:14.662 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:31:14.663 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 17:31:14.663 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:31:14.665 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764174657684-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5030, amount=40.50}]
2025-11-26 17:31:14.665 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:14.666 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 17:31:14.666 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657684-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5030, amount=40.50}]
2025-11-26 17:31:14.666 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:31:14.667 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Message 1764174657684-0 not acknowledged - will be retried
2025-11-26 17:31:14.668 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:14.668 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764174657684-0, message= Message 1764174657684-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 17:31:14.670 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:14.671 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:29.376 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:29.387 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:29.390 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-11-26 17:31:29.391 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-11-26 17:31:29.391 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-11-26 17:31:29.391 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:29.391 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:29.393 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:29.394 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:29.395 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:29.395 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:29.396 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:29.398 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:29.398 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 17:31:29.400 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764174657684-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5030, amount=40.50}]
2025-11-26 17:31:29.401 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 17:31:29.401 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657684-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=5030, amount=40.50}]
2025-11-26 17:31:29.402 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-11-26 17:31:29.507 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764174657684-0 in stream 'test-stream'
2025-11-26 17:31:29.510 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:31:29.511 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message 1764174657684-0 acknowledged successfully
2025-11-26 17:31:29.514 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:29.514 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764174657684-0, message= Message 1764174657684-0 processed successfully (deliveryCount: 2), deliveryCount=2}]
2025-11-26 17:31:29.515 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:29.515 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:31.892 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:31.893 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:31.894 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:31.894 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:31.894 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:31.894 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:31.894 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:31.899 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:31.899 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:31.900 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:31.900 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:31.901 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:31.903 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:31.903 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:31:31.905 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764174657788-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7819, amount=53.64}]
2025-11-26 17:31:31.905 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-11-26 17:31:31.906 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-11-26 17:31:31.906 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657788-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7819, amount=53.64}]
2025-11-26 17:31:31.906 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:31:31.907 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Message 1764174657788-0 not acknowledged - will be retried
2025-11-26 17:31:31.908 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:31.908 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764174657788-0, message= Message 1764174657788-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-11-26 17:31:31.909 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:31.909 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:33.609 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:33.610 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:33.612 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:33.612 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:33.612 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:33.612 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:33.612 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:33.616 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:33.616 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:33.617 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:33.618 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:33.618 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:33.620 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-11-26 17:31:33.620 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-11-26 17:31:33.621 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764174657788-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=7819, amount=53.64}]
2025-11-26 17:31:33.621 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-11-26 17:31:33.622 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764174657788-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=7819, amount=53.64}]
2025-11-26 17:31:33.622 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-11-26 17:31:33.622 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Message 1764174657788-0 not acknowledged - will be retried
2025-11-26 17:31:33.623 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:33.623 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764174657788-0, message= Message 1764174657788-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-11-26 17:31:33.624 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:33.625 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-11-26 17:31:34.932 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-11-26 17:31:34.933 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-11-26 17:31:34.934 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-11-26 17:31:34.935 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-11-26 17:31:34.935 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-11-26 17:31:34.935 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-11-26 17:31:34.935 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-11-26 17:31:34.939 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-11-26 17:31:34.939 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-11-26 17:31:34.941 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-11-26 17:31:34.942 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-11-26 17:31:34.943 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-11-26 17:31:34.947 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-11-26 17:31:34.948 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-11-26 17:31:34.949 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-11-26 17:31:34.949 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-11-26 17:31:35.099 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-11-26 17:31:35.100 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-11-26 17:31:35.100 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-11-26 17:31:35.101 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-11-26 17:31:35.101 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
