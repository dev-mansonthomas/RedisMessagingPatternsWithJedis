2025-12-01 09:56:29.509 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 09:56:31.552 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 09:56:37.210 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 15618 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 09:56:37.210 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 09:56:37.210 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 09:56:37.476 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 09:56:37.481 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 09:56:37.481 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 09:56:37.497 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 09:56:37.497 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 270 ms
2025-12-01 09:56:37.512 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 09:56:37.527 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 09:56:37.527 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 09:56:37.527 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 09:56:37.528 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 09:56:37.528 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 09:56:37.585 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 09:56:37.586 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 09:56:37.618 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 09:56:37.621 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 09:56:37.629 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 09:56:37.662 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/test]}: runTestScenario(TestScenarioRequest)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{GET [/dlq/config]}: getConfig(String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
2025-12-01 09:56:37.666 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 09:56:37.667 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 09:56:37.668 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 16 mappings in 'requestMappingHandlerMapping'
2025-12-01 09:56:37.679 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 09:56:37.684 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 09:56:37.697 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 09:56:37.725 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 09:56:37.728 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.659 seconds (process running for 0.755)
2025-12-01 09:56:37.729 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 09:56:37.729 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 09:56:37.731 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 09:58:00.080 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 09:58:00.080 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 09:58:00.080 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 09:58:00.080 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 09:58:00.080 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 09:58:00.081 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@1a464fa3
2025-12-01 09:58:00.081 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@1dad01fe
2025-12-01 09:58:00.081 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 09:58:00.081 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-01 09:58:00.108 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 09:58:00.108 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764579480034", parameters={masked}
2025-12-01 09:58:00.108 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 09:58:00.110 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 09:58:00.111 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 09:58:00.111 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 09:58:00.111 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764579480034
2025-12-01 09:58:00.112 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:00.118 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 09:58:00.118 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 09:58:00.118 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 09:58:00.118 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 09:58:00.119 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/473/0tq0il0k/websocket", parameters={}
2025-12-01 09:58:00.119 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 09:58:00.119 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/473/0tq0il0k/websocket
2025-12-01 09:58:00.129 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 09:58:00.129 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 09:58:00.129 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-12-01 09:58:00.134 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=0tq0il0k]
2025-12-01 09:58:00.134 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: 0tq0il0k
2025-12-01 09:58:00.134 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: 0tq0il0k (Total active: 1)
2025-12-01 09:58:00.135 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:00.135 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:00.136 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764240014966-0, fields={type=order.created, order_id=1344, amount=104.64}}, {id=1764240014864-0, fields={type=order.created, order_id=2509, amount=41.87}}, {id=1764240014764-0, fields={type=order.created, order_id=4981, amount=109.88}}, {id=1764240014733-0, fields={type=order.created, order_id=7333, amount=29.92}}], streamName=test-stream}]
2025-12-01 09:58:00.136 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764240024279-0, fields={type=order.created, order_id=4981, amount=109.88}}], streamName=test-stream:dlq}]
2025-12-01 09:58:00.142 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:00.142 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:00.142 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:00.142 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:05.714 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 09:58:05.715 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 09:58:05.753 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=4552, amount=102.39}}]
2025-12-01 09:58:05.755 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 09:58:05.755 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=4552, amount=102.39}
2025-12-01 09:58:05.758 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764579485746-0
2025-12-01 09:58:05.771 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 09:58:05.772 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:05.772 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764579485746-0, streamName=test-stream}]
2025-12-01 09:58:05.773 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:05.773 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:05.777 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 09:58:05.777 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 09:58:05.778 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=7561, reason=customer_request}}]
2025-12-01 09:58:05.778 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 09:58:05.778 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=7561, reason=customer_request}
2025-12-01 09:58:05.779 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764579485767-0
2025-12-01 09:58:05.779 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 09:58:05.780 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:05.780 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764579485767-0, streamName=test-stream}]
2025-12-01 09:58:05.780 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:05.780 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:05.878 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 09:58:05.879 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 09:58:05.880 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=1924, amount=25.82}}]
2025-12-01 09:58:05.880 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 09:58:05.880 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=1924, amount=25.82}
2025-12-01 09:58:05.882 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764579485870-0
2025-12-01 09:58:05.882 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 09:58:05.884 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:05.884 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764579485870-0, streamName=test-stream}]
2025-12-01 09:58:05.885 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:05.885 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:05.980 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 09:58:05.981 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 09:58:05.983 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7967, amount=59.05}}]
2025-12-01 09:58:05.983 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 09:58:05.984 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7967, amount=59.05}
2025-12-01 09:58:05.986 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764579485974-0
2025-12-01 09:58:05.987 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 09:58:05.989 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:05.991 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764579485974-0, streamName=test-stream}]
2025-12-01 09:58:05.992 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:05.993 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 09:58:26.988 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 09:58:26.990 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 09:58:26.995 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 09:58:26.996 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 09:58:26.996 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 09:58:26.997 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 09:58:26.998 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 09:58:27.002 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 09:58:27.003 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 09:58:27.006 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 09:58:27.006 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 09:58:27.008 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 09:58:27.019 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 09:58:27.021 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 09:58:27.024 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764240014966-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1344, amount=104.64}]
2025-12-01 09:58:27.025 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 09:58:27.027 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 09:58:27.027 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764240014966-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1344, amount=104.64}]
2025-12-01 09:58:27.027 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 09:58:27.131 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764240014966-0 in stream 'test-stream'
2025-12-01 09:58:27.135 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 09:58:27.135 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message 1764240014966-0 acknowledged successfully
2025-12-01 09:58:27.138 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 09:58:27.139 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764240014966-0, message=âœ“ Message 1764240014966-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 09:58:27.140 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 09:58:27.141 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:15:48.612 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=0tq0il0k] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:15:48.613 [http-nio-8080-exec-5] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: 0tq0il0k (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:15:48.614 [http-nio-8080-exec-5] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: 0tq0il0k (Sent 7 messages, Remaining active: 0)
2025-12-01 10:15:48.679 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:15:48.679 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:15:48.681 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:15:48.681 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:15:48.684 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:15:48.684 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:15:48.684 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:15:48.684 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:15:48.685 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764580548679", parameters={masked}
2025-12-01 10:15:48.686 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 10:15:48.686 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 10:15:48.686 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 9 messages from stream 'test-stream'
2025-12-01 10:15:48.686 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764580548679
2025-12-01 10:15:48.687 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:15:48.687 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:15:48.687 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:15:48.687 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764240024279-0, fields={type=order.created, order_id=4981, amount=109.88}}], streamName=test-stream:dlq}]
2025-12-01 10:15:48.687 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=9, messages=[{id=1764580491791-0, fields={type=order.shipped, order_id=666, tracking=TEST12345}}, {id=1764579485974-0, fields={type=order.created, order_id=7967, amount=59.05}}, {id=1764579485870-0, fields={type=order.created, order_id=1924, amount=25.82}}, {id=1764579485767-0, fields={type=order.cancelled, order_id=7561, reason=customer_request}}, {id=1764579485746-0, fields={type=order.created, order_id=4552, amount=102.39}}, {id=1764240014966-0, fields={type=order.created, order_id=1344, amount=104.64}}, {id=1764240014864-0, fields={type=order.created, order_id=2509, amount=41.87}}, {id=1764240014764-0, fields={type=order.created, order_id=4981, amount=109.88}}, {id=1764240014733-0, fields={type=order.created, order_id=7333, amount=29.92}}], streamName=test-stream}]
2025-12-01 10:15:48.688 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:15:48.688 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:15:48.689 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:15:48.689 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:15:48.694 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/656/151cnp41/websocket", parameters={}
2025-12-01 10:15:48.695 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 10:15:48.695 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/656/151cnp41/websocket
2025-12-01 10:15:48.696 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:15:48.697 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=151cnp41]
2025-12-01 10:15:48.697 [http-nio-8080-exec-9] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: 151cnp41
2025-12-01 10:15:48.697 [http-nio-8080-exec-9] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: 151cnp41 (Total active: 1)
2025-12-01 10:15:55.132 [SockJS-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [0tq0il0k]
2025-12-01 10:16:08.488 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=151cnp41] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:16:08.489 [http-nio-8080-exec-10] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: 151cnp41 (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:16:08.489 [http-nio-8080-exec-10] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: 151cnp41 (Sent 0 messages, Remaining active: 0)
2025-12-01 10:16:08.542 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:16:08.542 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:16:08.543 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:16:08.543 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:16:08.543 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:16:08.543 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:16:08.544 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:16:08.544 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:16:08.546 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 10:16:08.546 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 10 messages from stream 'test-stream'
2025-12-01 10:16:08.547 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:16:08.547 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:16:08.548 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764240024279-0, fields={type=order.created, order_id=4981, amount=109.88}}], streamName=test-stream:dlq}]
2025-12-01 10:16:08.548 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=10, messages=[{id=1764580558357-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764580491791-0, fields={type=order.shipped, order_id=666, tracking=TEST12345}}, {id=1764579485974-0, fields={type=order.created, order_id=7967, amount=59.05}}, {id=1764579485870-0, fields={type=order.created, order_id=1924, amount=25.82}}, {id=1764579485767-0, fields={type=order.cancelled, order_id=7561, reason=customer_request}}, {id=1764579485746-0, fields={type=order.created, order_id=4552, amount=102.39}}, {id=1764240014966-0, fields={type=order.created, order_id=1344, amount=104.64}}, {id=1764240014864-0, fields={type=order.created, order_id=2509, amount=41.87}}, {id=1764240014764-0, fields={type=order.created, order_id=4981, amount=109.88}}, {id=1764240014733-0, fields={type=order.created, order_id=7333, amount=29.92}}], streamName=test-stream}]
2025-12-01 10:16:08.548 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764580568544", parameters={masked}
2025-12-01 10:16:08.548 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 10:16:08.549 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:16:08.549 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764580568544
2025-12-01 10:16:08.549 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:16:08.550 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:16:08.550 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:16:08.550 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:16:08.577 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/127/eccqku2i/websocket", parameters={}
2025-12-01 10:16:08.579 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3cd26422
2025-12-01 10:16:08.579 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/127/eccqku2i/websocket
2025-12-01 10:16:08.581 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:16:08.582 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eccqku2i]
2025-12-01 10:16:08.582 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: eccqku2i
2025-12-01 10:16:08.582 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: eccqku2i (Total active: 1)
2025-12-01 10:16:15.129 [SockJS-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [151cnp41]
2025-12-01 10:16:35.257 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 10:16:37.276 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 10:16:37.297 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=eccqku2i]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:16:37.310 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session eccqku2i
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:16:37.310 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eccqku2i (Sent 0 messages, Remaining active: 0)
2025-12-01 10:16:37.310 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eccqku2i] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-12-01 10:16:37.310 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: eccqku2i (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-12-01 10:16:37.310 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eccqku2i (Sent null messages, Remaining active: 0)
2025-12-01 10:28:26.986 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 30442 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 10:28:26.987 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 10:28:26.987 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 10:28:27.271 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 10:28:27.276 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 10:28:27.277 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 10:28:27.293 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 10:28:27.293 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 288 ms
2025-12-01 10:28:27.307 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 10:28:27.318 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 10:28:27.318 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 10:28:27.319 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 10:28:27.319 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 10:28:27.319 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 10:28:27.384 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 10:28:27.385 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 10:28:27.409 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 10:28:27.412 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 10:28:27.420 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 10:28:27.454 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{GET [/dlq/config]}: getConfig(String)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
2025-12-01 10:28:27.457 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 10:28:27.458 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 10:28:27.459 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-12-01 10:28:27.471 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 10:28:27.476 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 10:28:27.488 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 10:28:27.516 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 10:28:27.519 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.671 seconds (process running for 0.768)
2025-12-01 10:28:27.520 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 10:28:27.520 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 10:28:27.522 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 10:28:29.795 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 10:28:29.795 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 10:28:29.795 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 10:28:29.795 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 10:28:29.795 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 10:28:29.796 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@16da476c
2025-12-01 10:28:29.796 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@2e43c38d
2025-12-01 10:28:29.796 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 10:28:29.796 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-01 10:28:29.811 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764581309747", parameters={masked}
2025-12-01 10:28:29.813 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@af7e376
2025-12-01 10:28:29.816 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764581309747
2025-12-01 10:28:29.817 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:28:30.304 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/484/44k0cryn/websocket", parameters={}
2025-12-01 10:28:30.305 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@af7e376
2025-12-01 10:28:30.306 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/484/44k0cryn/websocket
2025-12-01 10:28:30.329 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:28:30.334 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=44k0cryn]
2025-12-01 10:28:30.335 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: 44k0cryn
2025-12-01 10:28:30.335 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: 44k0cryn (Total active: 1)
2025-12-01 10:34:30.927 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=44k0cryn] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:34:30.929 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: 44k0cryn (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:34:30.929 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: 44k0cryn (Sent 0 messages, Remaining active: 0)
2025-12-01 10:34:31.125 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764581671120", parameters={masked}
2025-12-01 10:34:31.125 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:34:31.125 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:34:31.126 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@af7e376
2025-12-01 10:34:31.127 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764581671120
2025-12-01 10:34:31.129 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:34:31.130 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:34:31.130 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:34:31.135 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/756/eyesav0v/websocket", parameters={}
2025-12-01 10:34:31.136 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@af7e376
2025-12-01 10:34:31.138 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/756/eyesav0v/websocket
2025-12-01 10:34:31.143 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:34:31.144 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eyesav0v]
2025-12-01 10:34:31.144 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: eyesav0v
2025-12-01 10:34:31.144 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: eyesav0v (Total active: 1)
2025-12-01 10:34:31.158 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:34:31.158 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:34:31.158 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:34:31.159 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:34:31.163 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 10:34:31.163 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 10 messages from stream 'test-stream'
2025-12-01 10:34:31.170 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:34:31.170 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:34:31.170 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764240024279-0, fields={type=order.created, order_id=4981, amount=109.88}}], streamName=test-stream:dlq}]
2025-12-01 10:34:31.170 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=10, messages=[{id=1764581659506-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764581657477-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764581655809-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764581646895-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764581574718-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764580618610-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764580577970-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764580558357-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764580491791-0, fields={type=order.shipped, order_id=666, tracking=TEST12345}}, {id=1764579485974-0, fields={type=order.created, order_id=7967, amount=59.05}}], streamName=test-stream}]
2025-12-01 10:34:31.177 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:34:31.177 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:34:31.177 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:34:31.177 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:34:40.313 [SockJS-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [44k0cryn]
2025-12-01 10:35:01.078 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 10:35:03.094 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 10:35:03.133 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=eyesav0v]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:35:03.136 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session eyesav0v
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:35:03.137 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eyesav0v (Sent 0 messages, Remaining active: 0)
2025-12-01 10:35:03.137 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eyesav0v] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-12-01 10:35:03.137 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: eyesav0v (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-12-01 10:35:03.137 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eyesav0v (Sent null messages, Remaining active: 0)
2025-12-01 10:44:28.795 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 36786 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 10:44:28.796 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 10:44:28.796 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 10:44:29.073 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 10:44:29.077 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 10:44:29.077 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 10:44:29.095 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 10:44:29.095 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 281 ms
2025-12-01 10:44:29.110 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 10:44:29.121 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 10:44:29.121 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 10:44:29.122 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 10:44:29.122 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 10:44:29.122 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 10:44:29.189 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 10:44:29.189 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 10:44:29.217 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 10:44:29.225 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 10:44:29.233 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 10:44:29.262 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
	{GET [/dlq/config]}: getConfig(String)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
2025-12-01 10:44:29.271 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 10:44:29.272 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 10:44:29.273 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-12-01 10:44:29.285 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 10:44:29.290 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 10:44:29.301 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 10:44:29.330 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 10:44:29.333 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.681 seconds (process running for 0.774)
2025-12-01 10:44:29.334 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 10:44:29.334 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 10:44:29.336 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 10:44:54.308 [http-nio-8080-exec-3] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 10:44:54.309 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 10:44:54.309 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 10:44:54.309 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 10:44:54.309 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 10:44:54.311 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@3290b1a6
2025-12-01 10:44:54.311 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@16da476c
2025-12-01 10:44:54.319 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 10:44:54.319 [http-nio-8080-exec-3] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 10 ms
2025-12-01 10:44:54.333 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582294236", parameters={masked}
2025-12-01 10:44:54.333 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:44:54.333 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:44:54.337 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1e79d43
2025-12-01 10:44:54.338 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:44:54.338 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:44:54.338 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582294236
2025-12-01 10:44:54.339 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:44:54.343 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/541/k0hszp3n/websocket", parameters={}
2025-12-01 10:44:54.344 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1e79d43
2025-12-01 10:44:54.344 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/541/k0hszp3n/websocket
2025-12-01 10:44:54.347 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:44:54.347 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:44:54.347 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:44:54.347 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:44:54.353 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 10:44:54.353 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 10:44:54.355 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:44:54.358 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=k0hszp3n]
2025-12-01 10:44:54.358 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:44:54.358 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:44:54.358 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: k0hszp3n
2025-12-01 10:44:54.359 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: k0hszp3n (Total active: 1)
2025-12-01 10:44:54.359 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 10:44:54.359 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 10:44:54.365 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:44:54.365 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:44:54.366 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:44:54.366 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:33.454 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 10:45:35.473 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 10:45:35.512 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=k0hszp3n]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:45:35.524 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session k0hszp3n
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:45:35.526 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: k0hszp3n (Sent 0 messages, Remaining active: 0)
2025-12-01 10:45:35.528 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=k0hszp3n] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-12-01 10:45:35.528 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: k0hszp3n (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-12-01 10:45:35.528 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: k0hszp3n (Sent null messages, Remaining active: 0)
2025-12-01 10:45:48.179 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 37554 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 10:45:48.180 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 10:45:48.180 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 10:45:48.459 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 10:45:48.464 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 10:45:48.464 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 10:45:48.479 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 10:45:48.480 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 284 ms
2025-12-01 10:45:48.493 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 10:45:48.503 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 10:45:48.503 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 10:45:48.504 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 10:45:48.504 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 10:45:48.505 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 10:45:48.562 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 10:45:48.563 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 10:45:48.585 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 10:45:48.590 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 10:45:48.598 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 10:45:48.626 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{GET [/dlq/config]}: getConfig(String)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
2025-12-01 10:45:48.630 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 10:45:48.631 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 10:45:48.632 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-12-01 10:45:48.648 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 10:45:48.654 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 10:45:48.666 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 10:45:48.694 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 10:45:48.696 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.645 seconds (process running for 0.741)
2025-12-01 10:45:48.697 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 10:45:48.697 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 10:45:48.700 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 10:45:50.558 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 10:45:50.558 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 10:45:50.558 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 10:45:50.558 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 10:45:50.558 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 10:45:50.559 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@32faa16c
2025-12-01 10:45:50.559 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@24c8d8be
2025-12-01 10:45:50.560 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 10:45:50.560 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-01 10:45:50.575 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582350509", parameters={masked}
2025-12-01 10:45:50.577 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:50.580 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582350509
2025-12-01 10:45:50.581 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:50.587 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/071/nk0kof4j/websocket", parameters={}
2025-12-01 10:45:50.588 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:50.588 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/071/nk0kof4j/websocket
2025-12-01 10:45:50.599 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:45:50.603 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=nk0kof4j]
2025-12-01 10:45:50.603 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: nk0kof4j
2025-12-01 10:45:50.603 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: nk0kof4j (Total active: 1)
2025-12-01 10:45:55.625 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=nk0kof4j] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:45:55.626 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: nk0kof4j (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:45:55.626 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: nk0kof4j (Sent 0 messages, Remaining active: 0)
2025-12-01 10:45:55.794 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:45:55.794 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:45:55.799 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582355795", parameters={masked}
2025-12-01 10:45:55.800 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:55.801 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582355795
2025-12-01 10:45:55.803 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:55.803 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:45:55.804 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:45:55.810 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/688/eikgiozh/websocket", parameters={}
2025-12-01 10:45:55.810 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:55.812 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/688/eikgiozh/websocket
2025-12-01 10:45:55.814 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:45:55.821 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eikgiozh]
2025-12-01 10:45:55.821 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: eikgiozh
2025-12-01 10:45:55.821 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: eikgiozh (Total active: 1)
2025-12-01 10:45:55.835 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:45:55.835 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:45:55.835 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:45:55.835 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:45:55.839 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 10:45:55.839 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 10:45:55.847 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:45:55.847 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:45:55.848 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 10:45:55.848 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 10:45:55.856 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:45:55.856 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:45:55.857 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:55.857 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:57.924 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eikgiozh] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:45:57.924 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: eikgiozh (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:45:57.925 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eikgiozh (Sent 0 messages, Remaining active: 0)
2025-12-01 10:45:58.046 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:45:58.046 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:45:58.046 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:45:58.047 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:45:58.047 [http-nio-8080-exec-9] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:45:58.047 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:45:58.047 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:45:58.047 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:45:58.048 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582358046", parameters={masked}
2025-12-01 10:45:58.049 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:58.049 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582358046
2025-12-01 10:45:58.050 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 10:45:58.049 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 10:45:58.050 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:58.051 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:45:58.051 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 10:45:58.051 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:45:58.051 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 10:45:58.052 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:45:58.054 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:45:58.054 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:58.054 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:45:58.056 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/678/eszy0rbq/websocket", parameters={}
2025-12-01 10:45:58.057 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@36aab105
2025-12-01 10:45:58.058 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/678/eszy0rbq/websocket
2025-12-01 10:45:58.059 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:45:58.061 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eszy0rbq]
2025-12-01 10:45:58.061 [http-nio-8080-exec-10] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: eszy0rbq
2025-12-01 10:45:58.062 [http-nio-8080-exec-10] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: eszy0rbq (Total active: 1)
2025-12-01 10:46:05.594 [SockJS-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [nk0kof4j, eikgiozh]
2025-12-01 10:46:53.859 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 10:46:55.883 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 10:46:55.915 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=eszy0rbq]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:46:55.920 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session eszy0rbq
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 10:46:55.922 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eszy0rbq (Sent 0 messages, Remaining active: 0)
2025-12-01 10:46:55.922 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eszy0rbq] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-12-01 10:46:55.922 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: eszy0rbq (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-12-01 10:46:55.922 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: eszy0rbq (Sent null messages, Remaining active: 0)
2025-12-01 10:47:04.064 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 38182 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 10:47:04.065 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 10:47:04.065 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 10:47:04.356 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 10:47:04.361 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 10:47:04.361 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 10:47:04.376 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 10:47:04.376 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 293 ms
2025-12-01 10:47:04.390 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 10:47:04.400 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 10:47:04.400 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 10:47:04.405 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 10:47:04.405 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 10:47:04.405 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 10:47:04.461 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 10:47:04.461 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 10:47:04.485 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 10:47:04.488 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 10:47:04.496 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 10:47:04.531 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{GET [/dlq/config]}: getConfig(String)
2025-12-01 10:47:04.536 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 10:47:04.537 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 10:47:04.538 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-12-01 10:47:04.551 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 10:47:04.555 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 10:47:04.567 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 10:47:04.596 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 10:47:04.599 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.665 seconds (process running for 0.757)
2025-12-01 10:47:04.599 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 10:47:04.599 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 10:47:04.602 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 10:47:04.965 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 10:47:04.966 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 10:47:04.966 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 10:47:04.966 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 10:47:04.966 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 10:47:04.966 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@32faa16c
2025-12-01 10:47:04.967 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@24c8d8be
2025-12-01 10:47:04.967 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 10:47:04.967 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-01 10:47:04.981 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582424916", parameters={masked}
2025-12-01 10:47:04.984 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:04.986 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582424916
2025-12-01 10:47:04.987 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:04.994 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/461/mn1l4czc/websocket", parameters={}
2025-12-01 10:47:04.994 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:04.994 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/461/mn1l4czc/websocket
2025-12-01 10:47:05.005 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:47:05.009 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=mn1l4czc]
2025-12-01 10:47:05.009 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: mn1l4czc
2025-12-01 10:47:05.009 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: mn1l4czc (Total active: 1)
2025-12-01 10:47:15.894 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=mn1l4czc] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:47:15.897 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: mn1l4czc (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:47:15.898 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: mn1l4czc (Sent 0 messages, Remaining active: 0)
2025-12-01 10:47:16.114 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:47:16.114 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:47:16.115 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:47:16.116 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582436113", parameters={masked}
2025-12-01 10:47:16.115 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:47:16.116 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:16.116 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582436113
2025-12-01 10:47:16.117 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.121 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/028/fotdcfiw/websocket", parameters={}
2025-12-01 10:47:16.121 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:16.121 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/028/fotdcfiw/websocket
2025-12-01 10:47:16.123 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:47:16.123 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=fotdcfiw]
2025-12-01 10:47:16.124 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: fotdcfiw
2025-12-01 10:47:16.124 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: fotdcfiw (Total active: 1)
2025-12-01 10:47:16.134 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:47:16.134 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:47:16.134 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:47:16.135 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:47:16.144 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 10:47:16.146 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream'
2025-12-01 10:47:16.151 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:47:16.151 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:47:16.152 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 10:47:16.152 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 10:47:16.157 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:47:16.157 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:47:16.158 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.158 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.257 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=fotdcfiw] closed with CloseStatus[code=1000, reason=null]
2025-12-01 10:47:16.258 [http-nio-8080-exec-9] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: fotdcfiw (Status: CloseStatus[code=1000, reason=null])
2025-12-01 10:47:16.258 [http-nio-8080-exec-9] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: fotdcfiw (Sent 0 messages, Remaining active: 0)
2025-12-01 10:47:16.369 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 10:47:16.369 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 10:47:16.369 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:47:16.370 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 10:47:16.370 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 10:47:16.371 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 10:47:16.371 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 10:47:16.371 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 10:47:16.372 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764582436368", parameters={masked}
2025-12-01 10:47:16.372 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:16.373 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764582436368
2025-12-01 10:47:16.373 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.374 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream'
2025-12-01 10:47:16.374 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 10:47:16.375 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:47:16.375 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 10:47:16.375 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 10:47:16.375 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 10:47:16.377 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:47:16.377 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 10:47:16.377 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.377 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 10:47:16.378 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/562/lclugekr/websocket", parameters={}
2025-12-01 10:47:16.379 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1a07bf6
2025-12-01 10:47:16.380 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/562/lclugekr/websocket
2025-12-01 10:47:16.381 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 10:47:16.382 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lclugekr]
2025-12-01 10:47:16.383 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: lclugekr
2025-12-01 10:47:16.383 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: lclugekr (Total active: 1)
2025-12-01 10:47:25.002 [SockJS-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [mn1l4czc, fotdcfiw]
2025-12-01 11:18:38.538 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-12-01 11:18:40.557 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-12-01 11:18:40.580 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=lclugekr]
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 11:18:40.585 [SpringApplicationShutdownHook] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session lclugekr
java.io.IOException: java.nio.channels.ClosedChannelException
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:326)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:266)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:777)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:574)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:541)
	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:529)
	at org.apache.tomcat.websocket.WsWebSocketContainer.destroy(WsWebSocketContainer.java:1034)
	at org.apache.tomcat.websocket.server.WsContextListener.contextDestroyed(WsContextListener.java:46)
	at org.apache.catalina.core.StandardContext.listenerStop(StandardContext.java:4078)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:4688)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1217)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1206)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:328)
	at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:81)
	at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:149)
	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:812)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:466)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:913)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:235)
	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:446)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.stopTomcat(TomcatWebServer.java:301)
	at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.destroy(TomcatWebServer.java:374)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.doClose(ServletWebServerApplicationContext.java:182)
	at org.springframework.context.support.AbstractApplicationContext.close(AbstractApplicationContext.java:1129)
	at org.springframework.boot.SpringApplicationShutdownHook.closeAndWait(SpringApplicationShutdownHook.java:147)
	at java.base/java.lang.Iterable.forEach(Iterable.java:75)
	at org.springframework.boot.SpringApplicationShutdownHook.run(SpringApplicationShutdownHook.java:116)
	at java.base/java.lang.Thread.run(Thread.java:1474)
Caused by: java.nio.channels.ClosedChannelException: null
	at org.apache.tomcat.util.net.NioChannel$1.write(NioChannel.java:282)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1670)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:987)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1358)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1287)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1262)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:173)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:521)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlockInternal(WsRemoteEndpointImplBase.java:313)
	... 37 common frames omitted
2025-12-01 11:18:40.585 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: lclugekr (Sent 0 messages, Remaining active: 0)
2025-12-01 11:18:40.586 [SpringApplicationShutdownHook] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lclugekr] closed with CloseStatus[code=1001, reason=The web application is stopping]
2025-12-01 11:18:40.586 [SpringApplicationShutdownHook] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: lclugekr (Status: CloseStatus[code=1001, reason=The web application is stopping])
2025-12-01 11:18:40.586 [SpringApplicationShutdownHook] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: lclugekr (Sent null messages, Remaining active: 0)
2025-12-01 11:18:46.983 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Starting RedisMessagingPatternsApplication using Java 25.0.1 with PID 50604 (/Users/thomas.manson/Projects/RedisDLQJedis/target/classes started by thomas.manson in /Users/thomas.manson/Projects/RedisDLQJedis)
2025-12-01 11:18:46.984 [main] DEBUG c.r.p.RedisMessagingPatternsApplication - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-12-01 11:18:46.984 [main] INFO  c.r.p.RedisMessagingPatternsApplication - No active profile set, falling back to 1 default profile: "default"
2025-12-01 11:18:47.279 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-12-01 11:18:47.283 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-01 11:18:47.283 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-12-01 11:18:47.298 [main] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring embedded WebApplicationContext
2025-12-01 11:18:47.298 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 296 ms
2025-12-01 11:18:47.313 [main] DEBUG o.s.web.filter.CorsFilter - Filter 'corsFilter' configured for use
2025-12-01 11:18:47.325 [main] INFO  c.redis.patterns.config.RedisConfig - Initializing Redis connection pool...
2025-12-01 11:18:47.325 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Host: localhost
2025-12-01 11:18:47.326 [main] INFO  c.redis.patterns.config.RedisConfig - Redis Port: 6379
2025-12-01 11:18:47.326 [main] INFO  c.redis.patterns.config.RedisConfig - Pool Configuration - MaxTotal: 50, MaxIdle: 20, MinIdle: 5
2025-12-01 11:18:47.326 [main] INFO  c.redis.patterns.config.RedisConfig - Creating Redis pool without authentication
2025-12-01 11:18:47.385 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection test successful: PONG
2025-12-01 11:18:47.385 [main] INFO  c.redis.patterns.config.RedisConfig - Redis connection pool initialized successfully
2025-12-01 11:18:47.408 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Checking Redis Lua functions...
2025-12-01 11:18:47.411 [main] INFO  c.r.p.service.RedisLuaFunctionLoader - Function library 'stream_utils' already loaded in Redis
2025-12-01 11:18:47.420 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/ws/dlq-events/**] in 'webSocketHandlerMapping'
2025-12-01 11:18:47.452 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.DLQController:
	{DELETE [/dlq/cleanup]}: cleanup(String,String)
	{POST [/dlq/init]}: initializeConsumerGroup(DLQParameters)
	{POST [/dlq/claim]}: claimOrDLQ(DLQParameters)
	{POST [/dlq/produce]}: produceMessage(Map)
	{DELETE [/dlq/stream/{streamName}]}: deleteStream(String)
	{GET [/dlq/stats]}: getStats(String,String,String)
	{GET [/dlq/messages]}: getMessages(String,int)
	{POST [/dlq/config]}: saveConfig(DLQConfigRequest)
	{GET [/dlq/config/all]}: getAllConfigs()
	{POST [/dlq/process]}: processMessage(Map)
	{GET [/dlq/config]}: getConfig(String)
2025-12-01 11:18:47.456 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	c.r.p.c.PubSubController:
	{POST [/pubsub/publish]}: publishMessage(Map)
	{GET [/pubsub/health]}: health()
2025-12-01 11:18:47.457 [main] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - 
	o.s.b.a.w.s.e.BasicErrorController:
	{ [/error]}: error(HttpServletRequest)
	{ [/error], produces [text/html]}: errorHtml(HttpServletRequest,HttpServletResponse)
2025-12-01 11:18:47.462 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerMapping - 15 mappings in 'requestMappingHandlerMapping'
2025-12-01 11:18:47.477 [main] DEBUG o.s.w.s.h.SimpleUrlHandlerMapping - Patterns [/webjars/**, /**] in 'resourceHandlerMapping'
2025-12-01 11:18:47.482 [main] DEBUG o.s.w.s.m.m.a.RequestMappingHandlerAdapter - ControllerAdvice beans: 0 @ModelAttribute, 0 @InitBinder, 1 RequestBodyAdvice, 1 ResponseBodyAdvice
2025-12-01 11:18:47.493 [main] DEBUG o.s.w.s.m.m.a.ExceptionHandlerExceptionResolver - ControllerAdvice beans: 0 @ExceptionHandler, 1 ResponseBodyAdvice
2025-12-01 11:18:47.521 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api'
2025-12-01 11:18:47.524 [main] INFO  c.r.p.RedisMessagingPatternsApplication - Started RedisMessagingPatternsApplication in 0.677 seconds (process running for 0.771)
2025-12-01 11:18:47.525 [main] INFO  c.r.p.config.RedisPubSubConfig - Redis Pub/Sub subscriber thread started
2025-12-01 11:18:47.525 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubConfig - Starting Redis Pub/Sub subscriber for channel 'fire-and-forget'
2025-12-01 11:18:47.525 [main] INFO  c.r.p.s.RedisStreamListenerService - Starting Redis Stream Listener Service with Virtual Threads
2025-12-01 11:18:47.525 [main] INFO  c.r.p.s.RedisStreamListenerService - Starting monitoring for stream 'test-stream'
2025-12-01 11:18:47.527 [main] INFO  c.r.p.s.RedisStreamListenerService - Virtual Thread started for stream 'test-stream'
2025-12-01 11:18:47.527 [main] INFO  c.r.p.s.RedisStreamListenerService - Starting monitoring for stream 'test-stream:dlq'
2025-12-01 11:18:47.527 [stream-listener-test-stream] INFO  c.r.p.s.RedisStreamListenerService - Stream monitor started for 'test-stream'
2025-12-01 11:18:47.527 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Subscribed to channel 'fire-and-forget' (total: 1)
2025-12-01 11:18:47.527 [main] INFO  c.r.p.s.RedisStreamListenerService - Virtual Thread started for stream 'test-stream:dlq'
2025-12-01 11:18:47.527 [main] INFO  c.r.p.s.RedisStreamListenerService - Redis Stream Listener Service started successfully
2025-12-01 11:18:47.527 [stream-listener-test-stream:dlq] INFO  c.r.p.s.RedisStreamListenerService - Stream monitor started for 'test-stream:dlq'
2025-12-01 11:18:47.533 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764582382650-0
2025-12-01 11:18:47.533 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764582470401-0
2025-12-01 11:18:47.533 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764582505039-0
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[.[localhost].[/api] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected StandardServletMultipartResolver
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected AcceptHeaderLocaleResolver
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected FixedThemeResolver
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator@34be065a
2025-12-01 11:18:49.635 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Detected org.springframework.web.servlet.support.SessionFlashMapManager@20d33ea
2025-12-01 11:18:49.636 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - enableLoggingRequestDetails='false': request parameters and headers will be masked to prevent unsafe logging of potentially sensitive data
2025-12-01 11:18:49.636 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-01 11:18:49.644 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764584329588", parameters={masked}
2025-12-01 11:18:49.646 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:18:49.648 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764584329588
2025-12-01 11:18:49.649 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:18:49.656 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/270/lrrv3wtb/websocket", parameters={}
2025-12-01 11:18:49.656 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:18:49.656 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/270/lrrv3wtb/websocket
2025-12-01 11:18:49.666 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 11:18:49.669 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lrrv3wtb]
2025-12-01 11:18:49.670 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: lrrv3wtb
2025-12-01 11:18:49.670 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: lrrv3wtb (Total active: 1)
2025-12-01 11:18:58.601 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lrrv3wtb] closed with CloseStatus[code=1000, reason=null]
2025-12-01 11:18:58.602 [http-nio-8080-exec-2] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: lrrv3wtb (Status: CloseStatus[code=1000, reason=null])
2025-12-01 11:18:58.602 [http-nio-8080-exec-2] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: lrrv3wtb (Sent 0 messages, Remaining active: 0)
2025-12-01 11:18:58.777 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:18:58.777 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:18:58.779 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764584338776", parameters={masked}
2025-12-01 11:18:58.780 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:18:58.780 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764584338776
2025-12-01 11:18:58.781 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:18:58.781 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:18:58.781 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:18:58.784 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/291/lnz0e23h/websocket", parameters={}
2025-12-01 11:18:58.785 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:18:58.786 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/291/lnz0e23h/websocket
2025-12-01 11:18:58.787 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 11:18:58.788 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lnz0e23h]
2025-12-01 11:18:58.788 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: lnz0e23h
2025-12-01 11:18:58.788 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: lnz0e23h (Total active: 1)
2025-12-01 11:18:58.802 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:18:58.802 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:18:58.802 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:18:58.802 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:18:58.806 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 11:18:58.807 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 3 messages from stream 'test-stream'
2025-12-01 11:18:58.813 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:18:58.813 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:18:58.813 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=3, messages=[{id=1764582505039-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582470401-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 11:18:58.813 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 11:18:58.820 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:18:58.819 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:18:58.820 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:18:58.820 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:19:04.362 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:19:04.367 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584344332-0
2025-12-01 11:19:04.662 [SockJS-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [lrrv3wtb]
2025-12-01 11:19:12.506 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:19:12.507 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584352503-0
2025-12-01 11:19:17.920 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:19:17.921 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:19:17.950 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:19:17.952 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:19:17.952 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:19:17.953 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:19:17.953 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:19:17.954 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-12-01 11:19:17.954 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:17.955 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:19:17.955 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-12-01 11:19:17.956 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:17.956 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:19:17.956 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:19:17.959 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:19:17.960 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:19:17.961 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764582382650-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=667, tracking=TEST123456}]
2025-12-01 11:19:17.961 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:17.962 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:19:17.962 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764582382650-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=667, tracking=TEST123456}]
2025-12-01 11:19:17.963 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:19:18.068 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764582382650-0 in stream 'test-stream'
2025-12-01 11:19:18.070 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:19:18.071 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Message 1764582382650-0 acknowledged successfully
2025-12-01 11:19:18.072 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:19:18.073 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764582382650-0, message=âœ“ Message 1764582382650-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:19:18.075 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:19:18.075 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:19:21.253 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:19:21.255 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:19:21.256 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:19:21.257 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:19:21.257 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:19:21.257 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:19:21.257 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:19:21.261 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:19:21.261 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:19:21.264 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:19:21.264 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:19:21.265 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:19:21.268 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:19:21.268 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:19:21.270 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764582470401-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=667, tracking=TEST123456}]
2025-12-01 11:19:21.270 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:21.271 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:19:21.271 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764582470401-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=667, tracking=TEST123456}]
2025-12-01 11:19:21.272 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:19:21.374 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764582470401-0 in stream 'test-stream'
2025-12-01 11:19:21.377 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:19:21.378 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message 1764582470401-0 acknowledged successfully
2025-12-01 11:19:21.379 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:19:21.379 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764582470401-0, message=âœ“ Message 1764582470401-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:19:21.381 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:19:21.381 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:19:24.253 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:19:24.254 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:19:24.256 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:19:24.256 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:19:24.256 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:19:24.256 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:19:24.256 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:19:24.259 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:19:24.260 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:19:24.262 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:19:24.262 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:19:24.263 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:19:24.265 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:19:24.266 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:19:24.267 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764582505039-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=668, tracking=TEST123457}]
2025-12-01 11:19:24.268 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:24.269 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:19:24.269 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764582505039-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=668, tracking=TEST123457}]
2025-12-01 11:19:24.270 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:19:24.373 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764582505039-0 in stream 'test-stream'
2025-12-01 11:19:24.376 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:19:24.378 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message 1764582505039-0 acknowledged successfully
2025-12-01 11:19:24.379 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:19:24.382 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764582505039-0, message=âœ“ Message 1764582505039-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:19:24.384 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:19:24.384 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:19:26.720 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:19:26.722 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:19:26.723 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:19:26.724 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:19:26.724 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:19:26.724 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:19:26.725 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:19:26.728 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:19:26.729 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:19:26.731 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:19:26.731 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:19:26.732 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:19:26.734 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:19:26.734 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:19:26.735 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584344332-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=668, tracking=TEST123457}]
2025-12-01 11:19:26.735 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:19:26.736 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:19:26.736 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584344332-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=668, tracking=TEST123457}]
2025-12-01 11:19:26.736 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:19:26.840 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764584344332-0 in stream 'test-stream'
2025-12-01 11:19:26.844 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:19:26.845 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Message 1764584344332-0 acknowledged successfully
2025-12-01 11:19:26.846 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:19:26.846 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584344332-0, message=âœ“ Message 1764584344332-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:19:26.847 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:19:26.848 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:12.392 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:20:12.396 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:20:12.405 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 11:20:12.406 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 11:20:12.406 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 11:20:12.406 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:20:12.406 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:20:12.408 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:20:12.408 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:20:12.409 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:20:12.409 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:20:12.410 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:20:12.412 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:20:12.412 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:20:12.413 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584352503-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=669, tracking=TEST123457}]
2025-12-01 11:20:12.414 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:20:12.415 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:20:12.415 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584352503-0, deliveryCount=1, retry=false, fields={type=order.shipped, order_id=669, tracking=TEST123457}]
2025-12-01 11:20:12.416 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-12-01 11:20:12.417 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Message 1764584352503-0 not acknowledged - will be retried
2025-12-01 11:20:12.418 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:12.418 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584352503-0, message=âœ— Message 1764584352503-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:20:12.419 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:12.420 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:15.856 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:20:15.857 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:20:15.859 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 11:20:15.859 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 11:20:15.860 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 11:20:15.860 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:20:15.860 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:20:15.863 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:20:15.864 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:20:15.865 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:20:15.866 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:20:15.866 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:20:15.868 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-12-01 11:20:15.868 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-12-01 11:20:15.873 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764584352503-0, deliveryCount=2, retry=true, fields={type=order.shipped, order_id=669, tracking=TEST123457}]
2025-12-01 11:20:15.873 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-12-01 11:20:15.874 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584352503-0, deliveryCount=2, retry=true, fields={type=order.shipped, order_id=669, tracking=TEST123457}]
2025-12-01 11:20:15.874 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-12-01 11:20:15.875 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Message 1764584352503-0 not acknowledged - will be retried
2025-12-01 11:20:15.877 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:15.877 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764584352503-0, message=âœ— Message 1764584352503-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-12-01 11:20:15.879 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:15.880 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:19.889 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:20:19.892 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:20:19.893 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 11:20:19.894 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 11:20:19.895 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 11:20:19.895 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:20:19.895 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:20:19.898 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:20:19.898 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:20:19.900 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:20:19.901 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:20:19.901 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:20:19.904 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:20:19.904 [stream-listener-test-stream:dlq] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:20:19.905 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-12-01 11:20:19.905 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:20:19.906 [stream-listener-test-stream:dlq] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream:dlq': 1764584419901-0
2025-12-01 11:20:20.029 [http-nio-8080-exec-4] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-12-01 11:20:20.031 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:20.031 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-12-01 11:20:20.032 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:20.032 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:43.368 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:20:43.368 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:20:43.371 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=2566, amount=25.93}}]
2025-12-01 11:20:43.372 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:20:43.372 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=2566, amount=25.93}
2025-12-01 11:20:43.375 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764584443374-0 (will be detected by stream listener)
2025-12-01 11:20:43.375 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:20:43.376 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:43.376 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764584443374-0, streamName=test-stream}]
2025-12-01 11:20:43.376 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584443374-0
2025-12-01 11:20:43.381 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:43.381 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:43.456 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:20:43.456 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:20:43.457 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=2518, reason=fraud_detected}}]
2025-12-01 11:20:43.457 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:20:43.457 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=2518, reason=fraud_detected}
2025-12-01 11:20:43.458 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764584443457-0 (will be detected by stream listener)
2025-12-01 11:20:43.458 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:20:43.459 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:43.459 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764584443457-0, streamName=test-stream}]
2025-12-01 11:20:43.459 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584443457-0
2025-12-01 11:20:43.460 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:43.460 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:43.556 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:20:43.556 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:20:43.557 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=6666, amount=53.88}}]
2025-12-01 11:20:43.558 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:20:43.558 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=6666, amount=53.88}
2025-12-01 11:20:43.560 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764584443558-0 (will be detected by stream listener)
2025-12-01 11:20:43.560 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:20:43.560 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:43.560 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764584443558-0, streamName=test-stream}]
2025-12-01 11:20:43.560 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584443558-0
2025-12-01 11:20:43.561 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:43.561 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:20:43.656 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:20:43.657 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:20:43.658 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=8130, amount=39.19}}]
2025-12-01 11:20:43.658 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:20:43.658 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=8130, amount=39.19}
2025-12-01 11:20:43.659 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764584443658-0 (will be detected by stream listener)
2025-12-01 11:20:43.660 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:20:43.660 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:20:43.660 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764584443658-0, streamName=test-stream}]
2025-12-01 11:20:43.660 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764584443658-0
2025-12-01 11:20:43.661 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:20:43.661 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:10.234 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lnz0e23h] closed with CloseStatus[code=1000, reason=null]
2025-12-01 11:24:10.235 [http-nio-8080-exec-6] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: lnz0e23h (Status: CloseStatus[code=1000, reason=null])
2025-12-01 11:24:10.235 [http-nio-8080-exec-6] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: lnz0e23h (Sent 25 messages, Remaining active: 0)
2025-12-01 11:24:10.476 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764584650465", parameters={masked}
2025-12-01 11:24:10.476 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:24:10.476 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:24:10.480 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:10.481 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:10.481 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:24:10.484 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764584650465
2025-12-01 11:24:10.486 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:10.493 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:24:10.493 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:24:10.493 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:24:10.493 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:24:10.497 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/910/c4qajp45/websocket", parameters={}
2025-12-01 11:24:10.497 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:24:10.498 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/910/c4qajp45/websocket
2025-12-01 11:24:10.501 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 9 messages from stream 'test-stream'
2025-12-01 11:24:10.503 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 11:24:10.503 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 11:24:10.503 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:10.504 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764584419901-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}], streamName=test-stream:dlq}]
2025-12-01 11:24:10.504 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=c4qajp45]
2025-12-01 11:24:10.504 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: c4qajp45
2025-12-01 11:24:10.504 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: c4qajp45 (Total active: 1)
2025-12-01 11:24:10.504 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:10.505 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=9, messages=[{id=1764584443658-0, fields={type=order.created, order_id=8130, amount=39.19}}, {id=1764584443558-0, fields={type=order.created, order_id=6666, amount=53.88}}, {id=1764584443457-0, fields={type=order.cancelled, order_id=2518, reason=fraud_detected}}, {id=1764584443374-0, fields={type=order.created, order_id=2566, amount=25.93}}, {id=1764584352503-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}, {id=1764584344332-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582505039-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582470401-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 11:24:10.506 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:10.507 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:10.507 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:10.507 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:19.663 [SockJS-11] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [lnz0e23h]
2025-12-01 11:24:33.253 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:24:33.253 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:24:33.256 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:33.256 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:33.276 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:24:33.276 [http-nio-8080-exec-9] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:24:33.276 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:24:33.276 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:24:33.284 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 11:24:33.284 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Read 9 messages from stream 'test-stream'
2025-12-01 11:24:33.311 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:33.311 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:33.311 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764584419901-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}], streamName=test-stream:dlq}]
2025-12-01 11:24:33.311 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=9, messages=[{id=1764584443658-0, fields={type=order.created, order_id=8130, amount=39.19}}, {id=1764584443558-0, fields={type=order.created, order_id=6666, amount=53.88}}, {id=1764584443457-0, fields={type=order.cancelled, order_id=2518, reason=fraud_detected}}, {id=1764584443374-0, fields={type=order.created, order_id=2566, amount=25.93}}, {id=1764584352503-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}, {id=1764584344332-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582505039-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582470401-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 11:24:33.320 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:33.320 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:33.321 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:33.321 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:54.772 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:24:54.772 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:24:54.780 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:54.780 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:24:54.832 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:24:54.832 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:24:54.834 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:24:54.834 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:24:54.844 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 9 messages from stream 'test-stream'
2025-12-01 11:24:54.844 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 11:24:54.847 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:54.847 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=9, messages=[{id=1764584443658-0, fields={type=order.created, order_id=8130, amount=39.19}}, {id=1764584443558-0, fields={type=order.created, order_id=6666, amount=53.88}}, {id=1764584443457-0, fields={type=order.cancelled, order_id=2518, reason=fraud_detected}}, {id=1764584443374-0, fields={type=order.created, order_id=2566, amount=25.93}}, {id=1764584352503-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}, {id=1764584344332-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582505039-0, fields={type=order.shipped, order_id=668, tracking=TEST123457}}, {id=1764582470401-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}, {id=1764582382650-0, fields={type=order.shipped, order_id=667, tracking=TEST123456}}], streamName=test-stream}]
2025-12-01 11:24:54.848 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:24:54.848 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764584419901-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}], streamName=test-stream:dlq}]
2025-12-01 11:24:54.850 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:54.850 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:24:54.850 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:24:54.850 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:48.451 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:48.454 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:48.466 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:48.471 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:48.472 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:48.473 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:48.474 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:48.476 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:48.476 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:48.478 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:48.478 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:48.479 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:48.483 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:48.484 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:48.487 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584443374-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=2566, amount=25.93}]
2025-12-01 11:27:48.488 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:27:48.489 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:27:48.489 [http-nio-8080-exec-8] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584443374-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=2566, amount=25.93}]
2025-12-01 11:27:48.490 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:27:48.592 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764584443374-0 in stream 'test-stream'
2025-12-01 11:27:48.594 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:27:48.595 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message 1764584443374-0 acknowledged successfully
2025-12-01 11:27:48.597 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:48.597 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584443374-0, message=âœ“ Message 1764584443374-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:27:48.599 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:48.600 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:51.278 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:51.279 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:51.280 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:51.281 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:51.281 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:51.281 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:51.281 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:51.284 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:51.284 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:51.286 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:51.286 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:51.287 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:51.289 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:51.289 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:51.290 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584443457-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2518, reason=fraud_detected}]
2025-12-01 11:27:51.290 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:27:51.291 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:27:51.291 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584443457-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2518, reason=fraud_detected}]
2025-12-01 11:27:51.291 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:27:51.394 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764584443457-0 in stream 'test-stream'
2025-12-01 11:27:51.397 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:27:51.397 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message 1764584443457-0 acknowledged successfully
2025-12-01 11:27:51.398 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:51.399 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584443457-0, message=âœ“ Message 1764584443457-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:27:51.400 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:51.400 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:53.413 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:53.413 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:53.414 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:53.415 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:53.415 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:53.415 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:53.415 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:53.417 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:53.417 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:53.418 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:53.419 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:53.419 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:53.421 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:53.421 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:53.422 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584443558-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=6666, amount=53.88}]
2025-12-01 11:27:53.423 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:27:53.423 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:27:53.424 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584443558-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=6666, amount=53.88}]
2025-12-01 11:27:53.424 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:27:53.526 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764584443558-0 in stream 'test-stream'
2025-12-01 11:27:53.528 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:27:53.529 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message 1764584443558-0 acknowledged successfully
2025-12-01 11:27:53.529 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:53.529 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584443558-0, message=âœ“ Message 1764584443558-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:27:53.531 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:53.531 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:55.280 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:55.281 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:55.283 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:55.283 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:55.283 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:55.283 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:55.284 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:55.287 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:55.287 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:55.288 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:55.288 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:55.289 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:55.292 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:55.292 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:55.293 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764584443658-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=8130, amount=39.19}]
2025-12-01 11:27:55.294 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:27:55.295 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:27:55.295 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764584443658-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=8130, amount=39.19}]
2025-12-01 11:27:55.295 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:27:55.401 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764584443658-0 in stream 'test-stream'
2025-12-01 11:27:55.403 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:27:55.404 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message 1764584443658-0 acknowledged successfully
2025-12-01 11:27:55.405 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:55.405 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764584443658-0, message=âœ“ Message 1764584443658-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:27:55.406 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:55.406 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:57.047 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:57.048 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:57.050 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:57.050 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:57.050 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:57.050 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:57.050 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:57.052 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:57.053 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:57.054 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:57.054 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:57.055 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:57.056 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:57.056 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:57.226 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-12-01 11:27:57.226 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:57.227 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-12-01 11:27:57.228 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:57.228 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:27:58.548 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:27:58.549 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:27:58.550 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:27:58.550 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:27:58.550 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:27:58.550 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:27:58.550 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:27:58.553 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:27:58.553 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:27:58.554 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:27:58.554 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:27:58.555 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:27:58.557 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:27:58.557 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:27:58.694 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-12-01 11:27:58.695 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:27:58.696 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-12-01 11:27:58.698 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:27:58.698 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:28:59.223 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:28:59.229 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:28:59.237 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:28:59.239 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:28:59.239 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:28:59.239 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:28:59.239 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:28:59.241 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:28:59.241 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:28:59.242 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:28:59.242 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:28:59.243 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:28:59.247 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:28:59.248 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:28:59.380 [http-nio-8080-exec-2] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-12-01 11:28:59.381 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:28:59.381 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-12-01 11:28:59.383 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:28:59.384 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:31:46.135 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:31:46.137 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:31:46.142 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:31:46.143 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:31:46.143 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:31:46.144 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:31:46.144 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:31:46.146 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:31:46.146 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:31:46.148 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:31:46.148 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:31:46.149 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:31:46.150 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:31:46.150 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:31:46.335 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Returning 0 messages (0 retries, 0 new)
2025-12-01 11:31:46.336 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:31:46.336 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=false, message=No messages available to process}]
2025-12-01 11:31:46.338 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:31:46.339 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:07.688 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-12-01 11:37:07.688 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-12-01 11:37:07.697 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 11:37:07.697 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 11:37:07.705 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-12-01 11:37:07.705 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-12-01 11:37:07.705 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-12-01 11:37:07.705 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-12-01 11:37:07.706 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-12-01 11:37:07.706 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-12-01 11:37:07.707 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:07.707 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:07.708 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:07.708 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:07.708 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-12-01 11:37:07.708 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-12-01 11:37:07.708 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:07.708 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:07.709 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:07.709 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:07.711 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:37:07.711 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:37:07.712 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:37:07.712 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:37:07.712 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:37:07.712 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:37:07.712 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:37:07.712 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:37:07.714 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 11:37:07.714 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 11:37:07.714 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:07.714 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:07.714 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 11:37:07.714 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 11:37:07.716 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:07.716 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:07.716 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:07.716 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:12.619 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:37:12.619 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:37:12.623 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=6891, reason=payment_failed}}]
2025-12-01 11:37:12.626 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:37:12.626 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=6891, reason=payment_failed}
2025-12-01 11:37:12.629 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764585432627-0 (will be detected by stream listener)
2025-12-01 11:37:12.629 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:37:12.630 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:12.630 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764585432627-0, streamName=test-stream}]
2025-12-01 11:37:12.630 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764585432627-0
2025-12-01 11:37:12.631 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:12.632 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:12.709 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:37:12.710 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:37:12.711 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=2669, reason=payment_failed}}]
2025-12-01 11:37:12.711 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:37:12.711 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=2669, reason=payment_failed}
2025-12-01 11:37:12.714 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764585432712-0 (will be detected by stream listener)
2025-12-01 11:37:12.714 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:37:12.715 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:12.715 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764585432712-0
2025-12-01 11:37:12.715 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764585432712-0, streamName=test-stream}]
2025-12-01 11:37:12.716 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:12.716 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:12.811 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:37:12.812 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:37:12.814 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=9765, amount=87.66}}]
2025-12-01 11:37:12.815 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:37:12.816 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=9765, amount=87.66}
2025-12-01 11:37:12.818 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764585432817-0 (will be detected by stream listener)
2025-12-01 11:37:12.819 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:37:12.819 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:12.820 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764585432817-0, streamName=test-stream}]
2025-12-01 11:37:12.820 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764585432817-0
2025-12-01 11:37:12.821 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:12.822 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:12.915 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:37:12.915 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:37:12.916 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=5694, amount=11.85}}]
2025-12-01 11:37:12.917 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:37:12.917 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=5694, amount=11.85}
2025-12-01 11:37:12.919 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764585432918-0 (will be detected by stream listener)
2025-12-01 11:37:12.919 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:37:12.920 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:12.920 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764585432918-0, streamName=test-stream}]
2025-12-01 11:37:12.920 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764585432918-0
2025-12-01 11:37:12.922 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:12.923 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:15.576 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:37:15.577 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:37:15.579 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:37:15.579 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:37:15.579 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:37:15.579 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:37:15.579 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:37:15.582 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-12-01 11:37:15.583 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:15.584 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:37:15.586 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-12-01 11:37:15.586 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:15.587 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:37:15.588 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:37:15.590 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:37:15.590 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:37:15.591 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764585432627-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=6891, reason=payment_failed}]
2025-12-01 11:37:15.591 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:15.592 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:37:15.592 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764585432627-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=6891, reason=payment_failed}]
2025-12-01 11:37:15.592 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:37:15.696 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764585432627-0 in stream 'test-stream'
2025-12-01 11:37:15.699 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:37:15.699 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message 1764585432627-0 acknowledged successfully
2025-12-01 11:37:15.700 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:15.701 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764585432627-0, message=âœ“ Message 1764585432627-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:37:15.702 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:15.702 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:17.243 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:37:17.244 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:37:17.245 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:37:17.246 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:37:17.246 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:37:17.246 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:37:17.246 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:37:17.249 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:37:17.249 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:37:17.252 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:37:17.252 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:37:17.253 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:37:17.256 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:37:17.257 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:37:17.257 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764585432712-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2669, reason=payment_failed}]
2025-12-01 11:37:17.258 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:17.258 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:37:17.259 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764585432712-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=2669, reason=payment_failed}]
2025-12-01 11:37:17.259 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:37:17.364 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764585432712-0 in stream 'test-stream'
2025-12-01 11:37:17.368 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:37:17.368 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message 1764585432712-0 acknowledged successfully
2025-12-01 11:37:17.369 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:17.369 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764585432712-0, message=âœ“ Message 1764585432712-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:37:17.371 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:17.371 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:18.843 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:37:18.845 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:37:18.847 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:37:18.847 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:37:18.847 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:37:18.847 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:37:18.847 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:37:18.850 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:37:18.850 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:37:18.852 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:37:18.853 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:37:18.854 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:37:18.855 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:37:18.856 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:37:18.856 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764585432817-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9765, amount=87.66}]
2025-12-01 11:37:18.857 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:18.857 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:37:18.858 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764585432817-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9765, amount=87.66}]
2025-12-01 11:37:18.858 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:37:18.963 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764585432817-0 in stream 'test-stream'
2025-12-01 11:37:18.966 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:37:18.967 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message 1764585432817-0 acknowledged successfully
2025-12-01 11:37:18.967 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:18.967 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764585432817-0, message=âœ“ Message 1764585432817-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:37:18.968 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:18.968 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:20.275 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:37:20.275 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:37:20.276 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:37:20.277 [http-nio-8080-exec-9] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:37:20.277 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:37:20.277 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:37:20.277 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:37:20.279 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:37:20.279 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:37:20.280 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:37:20.281 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:37:20.282 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:37:20.285 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:37:20.285 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:37:20.286 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764585432918-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5694, amount=11.85}]
2025-12-01 11:37:20.287 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:20.287 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:37:20.287 [http-nio-8080-exec-9] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764585432918-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=5694, amount=11.85}]
2025-12-01 11:37:20.288 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:37:20.393 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764585432918-0 in stream 'test-stream'
2025-12-01 11:37:20.400 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:37:20.401 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Message 1764585432918-0 acknowledged successfully
2025-12-01 11:37:20.402 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:20.402 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764585432918-0, message=âœ“ Message 1764585432918-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:37:20.403 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:20.403 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:23.978 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-12-01 11:37:23.978 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-12-01 11:37:23.979 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 11:37:23.979 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 11:37:23.980 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-12-01 11:37:23.980 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-12-01 11:37:23.980 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-12-01 11:37:23.980 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-12-01 11:37:23.985 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-12-01 11:37:23.985 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-12-01 11:37:23.986 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:23.986 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:37:23.987 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:23.987 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:23.987 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-12-01 11:37:23.988 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-12-01 11:37:23.988 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:23.988 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:23.988 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:23.988 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:23.991 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:37:23.991 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:37:23.994 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:37:23.994 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:37:23.994 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:37:23.995 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:37:23.994 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:37:23.995 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:37:23.996 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 11:37:23.996 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 11:37:23.998 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:23.998 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:37:23.998 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 11:37:23.999 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:24.000 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:37:23.998 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 11:37:24.005 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:37:24.006 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:53:58.222 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=c4qajp45] closed with CloseStatus[code=1000, reason=null]
2025-12-01 11:53:58.223 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: c4qajp45 (Status: CloseStatus[code=1000, reason=null])
2025-12-01 11:53:58.224 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: c4qajp45 (Sent 34 messages, Remaining active: 0)
2025-12-01 11:53:58.422 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:53:58.422 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:53:58.423 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764586438412", parameters={masked}
2025-12-01 11:53:58.424 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:53:58.424 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:53:58.424 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:53:58.426 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764586438412
2025-12-01 11:53:58.427 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:53:58.427 [http-nio-8080-exec-5] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:53:58.427 [http-nio-8080-exec-10] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:53:58.427 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:53:58.427 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:53:58.430 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 11:53:58.431 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 11:53:58.432 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:53:58.432 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:53:58.433 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 11:53:58.433 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 11:53:58.433 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/238/zboag4r5/websocket", parameters={}
2025-12-01 11:53:58.440 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 11:53:58.441 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/238/zboag4r5/websocket
2025-12-01 11:53:58.442 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:53:58.444 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:53:58.442 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:53:58.446 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:53:58.448 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 11:53:58.448 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zboag4r5]
2025-12-01 11:53:58.449 [http-nio-8080-exec-1] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: zboag4r5
2025-12-01 11:53:58.449 [http-nio-8080-exec-1] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: zboag4r5 (Total active: 1)
2025-12-01 11:54:04.685 [SockJS-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [c4qajp45]
2025-12-01 11:54:04.970 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:54:04.971 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:54:04.972 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7012, amount=23.08}}]
2025-12-01 11:54:04.973 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:54:04.973 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7012, amount=23.08}
2025-12-01 11:54:04.975 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764586444973-0 (will be detected by stream listener)
2025-12-01 11:54:04.976 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:54:04.976 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:04.976 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764586444973-0, streamName=test-stream}]
2025-12-01 11:54:04.976 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764586444973-0
2025-12-01 11:54:04.976 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:04.977 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:54:05.061 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:54:05.062 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:54:05.063 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=1380, amount=65.30}}]
2025-12-01 11:54:05.063 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:54:05.063 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=1380, amount=65.30}
2025-12-01 11:54:05.066 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764586445063-0 (will be detected by stream listener)
2025-12-01 11:54:05.066 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:54:05.083 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764586445063-0
2025-12-01 11:54:05.084 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:05.084 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764586445063-0, streamName=test-stream}]
2025-12-01 11:54:05.084 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:05.085 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:54:05.162 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:54:05.163 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:54:05.164 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=7479, amount=63.40}}]
2025-12-01 11:54:05.164 [http-nio-8080-exec-4] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:54:05.164 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=7479, amount=63.40}
2025-12-01 11:54:05.167 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764586445165-0 (will be detected by stream listener)
2025-12-01 11:54:05.168 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:54:05.168 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:05.169 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764586445165-0
2025-12-01 11:54:05.169 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764586445165-0, streamName=test-stream}]
2025-12-01 11:54:05.169 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:05.171 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:54:05.264 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 11:54:05.265 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 11:54:05.266 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=8300, amount=42.74}}]
2025-12-01 11:54:05.266 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 11:54:05.266 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=8300, amount=42.74}
2025-12-01 11:54:05.268 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764586445266-0 (will be detected by stream listener)
2025-12-01 11:54:05.268 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:54:05.268 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:05.268 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764586445266-0, streamName=test-stream}]
2025-12-01 11:54:05.268 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764586445266-0
2025-12-01 11:54:05.270 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:05.270 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:54:21.809 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:54:21.811 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:54:21.812 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:54:21.812 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:54:21.812 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:54:21.812 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:54:21.813 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:54:21.814 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-12-01 11:54:21.815 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:54:21.815 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:54:21.816 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-12-01 11:54:21.816 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:54:21.817 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:54:21.817 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:54:21.819 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:54:21.819 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:54:21.820 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764586444973-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7012, amount=23.08}]
2025-12-01 11:54:21.820 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:54:21.821 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:54:21.821 [http-nio-8080-exec-6] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764586444973-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7012, amount=23.08}]
2025-12-01 11:54:21.821 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:54:21.927 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764586444973-0 in stream 'test-stream'
2025-12-01 11:54:21.928 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:54:21.929 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message 1764586444973-0 acknowledged successfully
2025-12-01 11:54:21.929 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:21.929 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764586444973-0, message=âœ“ Message 1764586444973-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:54:21.930 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:21.930 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:54:57.471 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:54:57.474 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:54:57.477 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 11:54:57.478 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 11:54:57.478 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 11:54:57.478 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:54:57.478 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:54:57.480 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:54:57.480 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:54:57.483 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:54:57.484 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:54:57.485 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:54:57.487 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 11:54:57.487 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:54:57.488 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764586445063-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1380, amount=65.30}]
2025-12-01 11:54:57.489 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:54:57.490 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:54:57.491 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764586445063-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=1380, amount=65.30}]
2025-12-01 11:54:57.491 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-12-01 11:54:57.492 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Message 1764586445063-0 not acknowledged - will be retried
2025-12-01 11:54:57.492 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:54:57.493 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764586445063-0, message=âœ— Message 1764586445063-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:54:57.500 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:54:57.500 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:55:03.278 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:55:03.279 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:55:03.280 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 11:55:03.280 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 11:55:03.281 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 11:55:03.281 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:55:03.281 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:55:03.283 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:55:03.284 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:55:03.285 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:55:03.285 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:55:03.285 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:55:03.287 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-12-01 11:55:03.287 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-12-01 11:55:03.289 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764586445063-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=1380, amount=65.30}]
2025-12-01 11:55:03.289 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-12-01 11:55:03.289 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764586445063-0, deliveryCount=2, retry=true, fields={type=order.created, order_id=1380, amount=65.30}]
2025-12-01 11:55:03.289 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-12-01 11:55:03.290 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Message 1764586445063-0 not acknowledged - will be retried
2025-12-01 11:55:03.291 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:55:03.292 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764586445063-0, message=âœ— Message 1764586445063-0 processing failed (will retry, deliveryCount: 2), deliveryCount=2}]
2025-12-01 11:55:03.293 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:55:03.293 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:55:13.674 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 11:55:13.675 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 11:55:13.677 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 11:55:13.678 [http-nio-8080-exec-1] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 11:55:13.678 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 11:55:13.678 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 11:55:13.678 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 11:55:13.681 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 11:55:13.681 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 11:55:13.684 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 11:55:13.684 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 11:55:13.685 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 11:55:13.686 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:55:13.686 [stream-listener-test-stream:dlq] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:55:13.687 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 1 sent to DLQ
2025-12-01 11:55:13.687 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 11:55:13.687 [stream-listener-test-stream:dlq] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream:dlq': 1764586513684-0
2025-12-01 11:55:13.688 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764586445165-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7479, amount=63.40}]
2025-12-01 11:55:13.688 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 11:55:13.689 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 11:55:13.689 [http-nio-8080-exec-1] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764586445165-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=7479, amount=63.40}]
2025-12-01 11:55:13.689 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 11:55:13.793 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764586445165-0 in stream 'test-stream'
2025-12-01 11:55:13.794 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 11:55:13.795 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Message 1764586445165-0 acknowledged successfully
2025-12-01 11:55:13.796 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:55:13.796 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764586445165-0, message=âœ“ Message 1764586445165-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 11:55:13.797 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:55:13.797 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:57:39.587 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 11:57:39.590 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764586659582-0
2025-12-01 11:58:13.311 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:13.312 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:13.314 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12345, status=created}}]
2025-12-01 11:58:13.315 [http-nio-8080-exec-4] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12345, status=created}}
2025-12-01 11:58:13.315 [http-nio-8080-exec-4] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12345, status=created}
2025-12-01 11:58:13.319 [http-nio-8080-exec-4] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:13.319 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12345,status=created
2025-12-01 11:58:13.322 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:13.322 [http-nio-8080-exec-4] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:13.324 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:13.325 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:13.325 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:13.325 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:13.325 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:14.345 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:14.345 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:14.346 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12346, status=cancelled}}]
2025-12-01 11:58:14.346 [http-nio-8080-exec-8] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12346, status=cancelled}}
2025-12-01 11:58:14.346 [http-nio-8080-exec-8] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12346, status=cancelled}
2025-12-01 11:58:14.348 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12346,status=cancelled
2025-12-01 11:58:14.349 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:14.348 [http-nio-8080-exec-8] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:14.353 [http-nio-8080-exec-8] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:14.351 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:14.358 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:14.358 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:14.359 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:14.359 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:14.980 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:14.981 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:14.982 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12347, status=created}}]
2025-12-01 11:58:14.982 [http-nio-8080-exec-6] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12347, status=created}}
2025-12-01 11:58:14.982 [http-nio-8080-exec-6] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12347, status=created}
2025-12-01 11:58:14.983 [http-nio-8080-exec-6] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:14.983 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12347,status=created
2025-12-01 11:58:14.984 [http-nio-8080-exec-6] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:14.984 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:14.985 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:14.985 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:14.985 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:14.985 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:14.985 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:15.555 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:15.555 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:15.556 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12348, status=created}}]
2025-12-01 11:58:15.556 [http-nio-8080-exec-7] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12348, status=created}}
2025-12-01 11:58:15.556 [http-nio-8080-exec-7] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12348, status=created}
2025-12-01 11:58:15.559 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12348,status=created
2025-12-01 11:58:15.559 [http-nio-8080-exec-7] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:15.559 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:15.559 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:15.559 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:15.560 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:15.560 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:15.560 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:15.560 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:16.044 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:16.044 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:16.045 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12349, status=cancelled}}]
2025-12-01 11:58:16.045 [http-nio-8080-exec-9] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12349, status=cancelled}}
2025-12-01 11:58:16.045 [http-nio-8080-exec-9] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12349, status=cancelled}
2025-12-01 11:58:16.046 [http-nio-8080-exec-9] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:16.047 [http-nio-8080-exec-9] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:16.047 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12349,status=cancelled
2025-12-01 11:58:16.047 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:16.048 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:16.048 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:16.048 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:16.049 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:16.049 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:16.464 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:16.464 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:16.465 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12350, status=updated}}]
2025-12-01 11:58:16.465 [http-nio-8080-exec-10] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12350, status=updated}}
2025-12-01 11:58:16.465 [http-nio-8080-exec-10] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12350, status=updated}
2025-12-01 11:58:16.467 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12350,status=updated
2025-12-01 11:58:16.467 [http-nio-8080-exec-10] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:16.467 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:16.468 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:16.468 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:16.469 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:16.469 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:16.470 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:16.470 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:16.855 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:16.856 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:16.856 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12351, status=created}}]
2025-12-01 11:58:16.857 [http-nio-8080-exec-5] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12351, status=created}}
2025-12-01 11:58:16.857 [http-nio-8080-exec-5] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12351, status=created}
2025-12-01 11:58:16.859 [http-nio-8080-exec-5] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:16.859 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12351,status=created
2025-12-01 11:58:16.860 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:16.860 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:16.861 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:16.861 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:16.861 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:16.862 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:16.862 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:17.304 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:17.304 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:17.306 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12352, status=created}}]
2025-12-01 11:58:17.306 [http-nio-8080-exec-1] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12352, status=created}}
2025-12-01 11:58:17.306 [http-nio-8080-exec-1] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12352, status=created}
2025-12-01 11:58:17.309 [http-nio-8080-exec-1] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:17.309 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12352,status=created
2025-12-01 11:58:17.310 [http-nio-8080-exec-1] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:17.310 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:17.310 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:17.311 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:17.311 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:17.312 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:17.312 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:17.722 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/pubsub/publish", parameters={}
2025-12-01 11:58:17.722 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.PubSubController#publishMessage(Map)
2025-12-01 11:58:17.723 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{channel=fire-and-forget, payload={type=order, id=12353, status=cancelled}}]
2025-12-01 11:58:17.723 [http-nio-8080-exec-3] INFO  c.r.p.controller.PubSubController - Received publish request: {channel=fire-and-forget, payload={type=order, id=12353, status=cancelled}}
2025-12-01 11:58:17.723 [http-nio-8080-exec-3] INFO  c.r.patterns.service.PubSubService - Publishing message to channel 'fire-and-forget': {type=order, id=12353, status=cancelled}
2025-12-01 11:58:17.725 [http-nio-8080-exec-3] INFO  c.r.patterns.service.PubSubService - Message published to 2 subscribers on channel 'fire-and-forget'
2025-12-01 11:58:17.725 [redis-pubsub-subscriber] INFO  c.r.p.config.RedisPubSubListener - Received message on channel 'fire-and-forget': type=order,id=12353,status=cancelled
2025-12-01 11:58:17.725 [redis-pubsub-subscriber] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_RECEIVED
2025-12-01 11:58:17.726 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting PubSubEvent to 1 sessions: MESSAGE_PUBLISHED
2025-12-01 11:58:17.726 [redis-pubsub-subscriber] DEBUG c.r.p.config.RedisPubSubListener - Message broadcasted to WebSocket clients
2025-12-01 11:58:17.727 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:17.727 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, subscriberCount=2, channel=fire-and-forget, message=Message published to 2 subscribers}]
2025-12-01 11:58:17.727 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:17.728 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:27.361 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 11:58:27.362 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 11:58:27.362 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:58:27.362 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 11:58:27.367 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 11:58:27.367 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 11:58:27.367 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 11:58:27.367 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 11:58:27.371 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 11:58:27.371 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 5 messages from stream 'test-stream'
2025-12-01 11:58:27.371 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:27.372 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764586513684-0, fields={type=order.created, order_id=1380, amount=65.30}}], streamName=test-stream:dlq}]
2025-12-01 11:58:27.373 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:27.373 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 11:58:27.373 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 11:58:27.374 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=5, messages=[{id=1764586659582-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}, {id=1764586445266-0, fields={type=order.created, order_id=8300, amount=42.74}}, {id=1764586445165-0, fields={type=order.created, order_id=7479, amount=63.40}}, {id=1764586445063-0, fields={type=order.created, order_id=1380, amount=65.30}}, {id=1764586444973-0, fields={type=order.created, order_id=7012, amount=23.08}}], streamName=test-stream}]
2025-12-01 11:58:27.375 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 11:58:27.375 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 13:29:07.685 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=zboag4r5]
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1333)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1218)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
2025-12-01 13:29:07.735 [http-nio-8080-exec-7] ERROR c.r.p.w.DLQEventWebSocketHandler - WebSocket transport error for session zboag4r5
java.io.EOFException: null
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1333)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1218)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:74)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:184)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:164)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:152)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:57)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1474)
2025-12-01 13:29:07.736 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: zboag4r5 (Sent 36 messages, Remaining active: 0)
2025-12-01 13:29:07.737 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zboag4r5] closed with CloseStatus[code=1006, reason=null]
2025-12-01 13:29:07.738 [http-nio-8080-exec-7] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: zboag4r5 (Status: CloseStatus[code=1006, reason=null])
2025-12-01 13:29:07.738 [http-nio-8080-exec-7] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: zboag4r5 (Sent null messages, Remaining active: 0)
2025-12-01 13:29:14.658 [SockJS-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [zboag4r5]
2025-12-01 15:34:33.400 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764599673371", parameters={masked}
2025-12-01 15:34:33.406 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 15:34:33.407 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764599673371
2025-12-01 15:34:33.409 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 15:34:33.414 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/327/qr4oqmaa/websocket", parameters={}
2025-12-01 15:34:33.414 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 15:34:33.415 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/327/qr4oqmaa/websocket
2025-12-01 15:34:33.418 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 15:34:33.419 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=qr4oqmaa]
2025-12-01 15:34:33.419 [http-nio-8080-exec-10] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: qr4oqmaa
2025-12-01 15:34:33.419 [http-nio-8080-exec-10] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: qr4oqmaa (Total active: 1)
2025-12-01 17:31:54.823 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=qr4oqmaa] closed with CloseStatus[code=1000, reason=null]
2025-12-01 17:31:54.826 [http-nio-8080-exec-1] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: qr4oqmaa (Status: CloseStatus[code=1000, reason=null])
2025-12-01 17:31:54.828 [http-nio-8080-exec-1] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: qr4oqmaa (Sent 0 messages, Remaining active: 0)
2025-12-01 17:31:54.974 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764606714950", parameters={masked}
2025-12-01 17:31:54.982 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:31:54.982 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764606714950
2025-12-01 17:31:54.983 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:31:54.995 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/507/pcwlnz1r/websocket", parameters={}
2025-12-01 17:31:54.995 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:31:54.996 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/507/pcwlnz1r/websocket
2025-12-01 17:31:55.004 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 17:31:55.006 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=pcwlnz1r]
2025-12-01 17:31:55.006 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: pcwlnz1r
2025-12-01 17:31:55.006 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: pcwlnz1r (Total active: 1)
2025-12-01 17:32:01.262 [SockJS-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [qr4oqmaa]
2025-12-01 17:33:17.348 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:33:17.348 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:33:17.352 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:17.352 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:17.391 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:33:17.391 [http-nio-8080-exec-8] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:33:17.391 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:33:17.391 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:33:17.395 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 1 messages from stream 'test-stream:dlq'
2025-12-01 17:33:17.395 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Read 5 messages from stream 'test-stream'
2025-12-01 17:33:17.399 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:17.399 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:17.399 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=5, messages=[{id=1764586659582-0, fields={type=order.shipped, order_id=669, tracking=TEST123457}}, {id=1764586445266-0, fields={type=order.created, order_id=8300, amount=42.74}}, {id=1764586445165-0, fields={type=order.created, order_id=7479, amount=63.40}}, {id=1764586445063-0, fields={type=order.created, order_id=1380, amount=65.30}}, {id=1764586444973-0, fields={type=order.created, order_id=7012, amount=23.08}}], streamName=test-stream}]
2025-12-01 17:33:17.400 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=1, messages=[{id=1764586513684-0, fields={type=order.created, order_id=1380, amount=65.30}}], streamName=test-stream:dlq}]
2025-12-01 17:33:17.404 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:17.404 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:17.404 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:17.404 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:20.274 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream:dlq", parameters={}
2025-12-01 17:33:20.274 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - DELETE "/api/dlq/stream/test-stream", parameters={}
2025-12-01 17:33:20.275 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 17:33:20.275 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#deleteStream(String)
2025-12-01 17:33:20.279 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream
2025-12-01 17:33:20.279 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream
2025-12-01 17:33:20.279 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Deleting stream: test-stream:dlq
2025-12-01 17:33:20.280 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Deleting stream: test-stream:dlq
2025-12-01 17:33:20.285 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream:dlq' deleted successfully
2025-12-01 17:33:20.285 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Stream 'test-stream' deleted successfully
2025-12-01 17:33:20.292 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:20.292 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:20.295 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:20.295 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:20.295 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream:dlq}]
2025-12-01 17:33:20.296 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, message=Stream deleted successfully, streamName=test-stream}]
2025-12-01 17:33:20.296 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:20.296 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:20.297 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:20.297 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:20.300 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:33:20.302 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:33:20.302 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:20.302 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:20.302 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:33:20.303 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:33:20.302 [http-nio-8080-exec-3] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:33:20.304 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:33:20.305 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 17:33:20.306 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream'
2025-12-01 17:33:20.306 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:20.306 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:20.306 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream}]
2025-12-01 17:33:20.306 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 17:33:20.307 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:20.307 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:20.307 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:20.307 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:21.647 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 17:33:21.649 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 17:33:21.654 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=9503, reason=out_of_stock}}]
2025-12-01 17:33:21.656 [http-nio-8080-exec-2] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 17:33:21.656 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=9503, reason=out_of_stock}
2025-12-01 17:33:21.658 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 17:33:21.658 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764606801656-0 (will be detected by stream listener)
2025-12-01 17:33:21.658 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764606801656-0
2025-12-01 17:33:21.659 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:21.659 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764606801656-0, streamName=test-stream}]
2025-12-01 17:33:21.660 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:21.660 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:21.735 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 17:33:21.736 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 17:33:21.738 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=3104, amount=97.57}}]
2025-12-01 17:33:21.738 [http-nio-8080-exec-6] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 17:33:21.738 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=3104, amount=97.57}
2025-12-01 17:33:21.741 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764606801740-0 (will be detected by stream listener)
2025-12-01 17:33:21.741 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 17:33:21.742 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:21.742 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764606801740-0, streamName=test-stream}]
2025-12-01 17:33:21.742 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764606801740-0
2025-12-01 17:33:21.743 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:21.744 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:21.836 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 17:33:21.837 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 17:33:21.838 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.cancelled, order_id=6956, reason=fraud_detected}}]
2025-12-01 17:33:21.838 [http-nio-8080-exec-8] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 17:33:21.839 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.cancelled, order_id=6956, reason=fraud_detected}
2025-12-01 17:33:21.841 [http-nio-8080-exec-8] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764606801840-0 (will be detected by stream listener)
2025-12-01 17:33:21.842 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 17:33:21.842 [http-nio-8080-exec-8] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:21.842 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764606801840-0, streamName=test-stream}]
2025-12-01 17:33:21.843 [http-nio-8080-exec-8] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:21.843 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764606801840-0
2025-12-01 17:33:21.844 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:21.937 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/produce", parameters={}
2025-12-01 17:33:21.939 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#produceMessage(Map)
2025-12-01 17:33:21.940 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{streamName=test-stream, payload={type=order.created, order_id=9880, amount=22.85}}]
2025-12-01 17:33:21.941 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Producing message to stream: test-stream
2025-12-01 17:33:21.941 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Producing message to stream 'test-stream': {type=order.created, order_id=9880, amount=22.85}
2025-12-01 17:33:21.945 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message produced with ID: 1764606801943-0 (will be detected by stream listener)
2025-12-01 17:33:21.945 [stream-listener-test-stream] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PRODUCED
2025-12-01 17:33:21.946 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:21.946 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, messageId=1764606801943-0, streamName=test-stream}]
2025-12-01 17:33:21.948 [stream-listener-test-stream] DEBUG c.r.p.s.RedisStreamListenerService - Detected new message in 'test-stream': 1764606801943-0
2025-12-01 17:33:21.949 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:21.950 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:23.357 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 17:33:23.358 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 17:33:23.359 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 17:33:23.359 [http-nio-8080-exec-5] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 17:33:23.359 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 17:33:23.361 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 17:33:23.361 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 17:33:23.364 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' created successfully
2025-12-01 17:33:23.364 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:23.365 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 17:33:23.368 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' created successfully
2025-12-01 17:33:23.368 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:23.369 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 17:33:23.370 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 17:33:23.373 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 17:33:23.374 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 17:33:23.375 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764606801656-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}]
2025-12-01 17:33:23.375 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:23.376 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 17:33:23.376 [http-nio-8080-exec-5] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764606801656-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}]
2025-12-01 17:33:23.376 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 17:33:23.480 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764606801656-0 in stream 'test-stream'
2025-12-01 17:33:23.482 [http-nio-8080-exec-5] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 17:33:23.483 [http-nio-8080-exec-5] DEBUG c.r.p.service.DLQMessagingService - Message 1764606801656-0 acknowledged successfully
2025-12-01 17:33:23.483 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:23.483 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764606801656-0, message=âœ“ Message 1764606801656-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 17:33:23.484 [http-nio-8080-exec-5] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:23.484 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:25.097 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 17:33:25.097 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 17:33:25.099 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 17:33:25.099 [http-nio-8080-exec-10] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 17:33:25.100 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 17:33:25.100 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 17:33:25.100 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 17:33:25.101 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 17:33:25.101 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 17:33:25.103 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 17:33:25.103 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 17:33:25.105 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 17:33:25.108 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 17:33:25.108 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 17:33:25.109 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764606801740-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=3104, amount=97.57}]
2025-12-01 17:33:25.109 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:25.109 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 17:33:25.110 [http-nio-8080-exec-10] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764606801740-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=3104, amount=97.57}]
2025-12-01 17:33:25.110 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 17:33:25.215 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764606801740-0 in stream 'test-stream'
2025-12-01 17:33:25.217 [http-nio-8080-exec-10] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 17:33:25.218 [http-nio-8080-exec-10] DEBUG c.r.p.service.DLQMessagingService - Message 1764606801740-0 acknowledged successfully
2025-12-01 17:33:25.218 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:25.218 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764606801740-0, message=âœ“ Message 1764606801740-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 17:33:25.219 [http-nio-8080-exec-10] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:25.219 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:26.710 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 17:33:26.710 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 17:33:26.711 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=false}]
2025-12-01 17:33:26.711 [http-nio-8080-exec-3] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=false
2025-12-01 17:33:26.711 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=false
2025-12-01 17:33:26.711 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 17:33:26.711 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 17:33:26.714 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 17:33:26.714 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 17:33:26.716 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 17:33:26.716 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 17:33:26.717 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 17:33:26.718 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 17:33:26.718 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 17:33:26.719 [http-nio-8080-exec-3] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764606801840-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}]
2025-12-01 17:33:26.719 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:33:26.720 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 17:33:26.720 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764606801840-0, deliveryCount=1, retry=false, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}]
2025-12-01 17:33:26.720 [http-nio-8080-exec-3] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_RECLAIMED
2025-12-01 17:33:26.721 [http-nio-8080-exec-3] INFO  c.r.p.service.DLQMessagingService - Message 1764606801840-0 not acknowledged - will be retried
2025-12-01 17:33:26.721 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:26.722 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764606801840-0, message=âœ— Message 1764606801840-0 processing failed (will retry, deliveryCount: 1), deliveryCount=1}]
2025-12-01 17:33:26.722 [http-nio-8080-exec-3] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:26.722 [http-nio-8080-exec-3] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:43.409 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=pcwlnz1r] closed with CloseStatus[code=1000, reason=null]
2025-12-01 17:33:43.412 [http-nio-8080-exec-1] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: pcwlnz1r (Status: CloseStatus[code=1000, reason=null])
2025-12-01 17:33:43.412 [http-nio-8080-exec-1] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: pcwlnz1r (Sent 16 messages, Remaining active: 0)
2025-12-01 17:33:43.535 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:33:43.535 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:33:43.540 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:43.540 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:33:43.541 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764606823536", parameters={masked}
2025-12-01 17:33:43.543 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:33:43.544 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764606823536
2025-12-01 17:33:43.545 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:33:43.545 [http-nio-8080-exec-4] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:33:43.545 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:33:43.545 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:33:43.545 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:43.547 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 17:33:43.547 [http-nio-8080-exec-4] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-12-01 17:33:43.548 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:43.548 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 17:33:43.549 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:43.549 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/315/ryi4oeqg/websocket", parameters={}
2025-12-01 17:33:43.549 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764606801943-0, fields={type=order.created, order_id=9880, amount=22.85}}, {id=1764606801840-0, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}}, {id=1764606801740-0, fields={type=order.created, order_id=3104, amount=97.57}}, {id=1764606801656-0, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}}], streamName=test-stream}]
2025-12-01 17:33:43.549 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:33:43.549 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:43.550 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:43.550 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/315/ryi4oeqg/websocket
2025-12-01 17:33:43.551 [http-nio-8080-exec-4] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:43.551 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:43.553 [http-nio-8080-exec-8] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 17:33:43.554 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ryi4oeqg]
2025-12-01 17:33:43.554 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: ryi4oeqg
2025-12-01 17:33:43.554 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: ryi4oeqg (Total active: 1)
2025-12-01 17:33:45.917 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 17:33:45.918 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 17:33:45.921 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 17:33:45.923 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 17:33:45.924 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 17:33:45.924 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 17:33:45.924 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 17:33:45.927 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 17:33:45.927 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 17:33:45.930 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 17:33:45.930 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 17:33:45.931 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 17:33:45.933 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 1 messages reclaimed, 0 sent to DLQ
2025-12-01 17:33:45.933 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Found 1 retry messages
2025-12-01 17:33:45.935 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added retry message: Message[id=1764606801840-0, deliveryCount=2, retry=true, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}]
2025-12-01 17:33:45.935 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (1 retries, 0 new)
2025-12-01 17:33:45.935 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764606801840-0, deliveryCount=2, retry=true, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}]
2025-12-01 17:33:45.935 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 17:33:46.041 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764606801840-0 in stream 'test-stream'
2025-12-01 17:33:46.043 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 17:33:46.044 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message 1764606801840-0 acknowledged successfully
2025-12-01 17:33:46.044 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:33:46.044 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=true, messageId=1764606801840-0, message=âœ“ Message 1764606801840-0 processed successfully (deliveryCount: 2), deliveryCount=2}]
2025-12-01 17:33:46.045 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:33:46.045 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:33:51.260 [SockJS-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [pcwlnz1r]
2025-12-01 17:34:49.951 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=ryi4oeqg] closed with CloseStatus[code=1000, reason=null]
2025-12-01 17:34:49.955 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: ryi4oeqg (Status: CloseStatus[code=1000, reason=null])
2025-12-01 17:34:49.964 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: ryi4oeqg (Sent 2 messages, Remaining active: 0)
2025-12-01 17:34:50.160 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:34:50.160 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:34:50.160 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764606890147", parameters={masked}
2025-12-01 17:34:50.161 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:34:50.161 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:34:50.161 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:34:50.162 [http-nio-8080-exec-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764606890147
2025-12-01 17:34:50.162 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:34:50.163 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:34:50.163 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:34:50.163 [http-nio-8080-exec-1] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:34:50.165 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:34:50.166 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/809/asmi2c55/websocket", parameters={}
2025-12-01 17:34:50.168 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:34:50.170 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/809/asmi2c55/websocket
2025-12-01 17:34:50.170 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 17:34:50.171 [http-nio-8080-exec-1] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-12-01 17:34:50.171 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:34:50.171 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:34:50.172 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 17:34:50.172 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764606801943-0, fields={type=order.created, order_id=9880, amount=22.85}}, {id=1764606801840-0, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}}, {id=1764606801740-0, fields={type=order.created, order_id=3104, amount=97.57}}, {id=1764606801656-0, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}}], streamName=test-stream}]
2025-12-01 17:34:50.172 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 17:34:50.173 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:34:50.173 [http-nio-8080-exec-1] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:34:50.173 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:34:50.173 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:34:50.173 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=asmi2c55]
2025-12-01 17:34:50.173 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: asmi2c55
2025-12-01 17:34:50.173 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: asmi2c55 (Total active: 1)
2025-12-01 17:34:56.261 [SockJS-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [ryi4oeqg]
2025-12-01 17:35:07.322 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=asmi2c55] closed with CloseStatus[code=1000, reason=null]
2025-12-01 17:35:07.325 [http-nio-8080-exec-8] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: asmi2c55 (Status: CloseStatus[code=1000, reason=null])
2025-12-01 17:35:07.326 [http-nio-8080-exec-8] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: asmi2c55 (Sent 0 messages, Remaining active: 0)
2025-12-01 17:35:07.464 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:35:07.464 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:35:07.464 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764606907460", parameters={masked}
2025-12-01 17:35:07.469 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:35:07.469 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:35:07.469 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:35:07.470 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764606907460
2025-12-01 17:35:07.473 [http-nio-8080-exec-5] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:07.481 [http-nio-8080-exec-7] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:35:07.481 [http-nio-8080-exec-9] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:35:07.481 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/352/zhfaxbge/websocket", parameters={}
2025-12-01 17:35:07.482 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:35:07.482 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:35:07.482 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:35:07.483 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/352/zhfaxbge/websocket
2025-12-01 17:35:07.485 [http-nio-8080-exec-10] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 17:35:07.485 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-12-01 17:35:07.485 [http-nio-8080-exec-9] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 17:35:07.486 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zhfaxbge]
2025-12-01 17:35:07.486 [http-nio-8080-exec-10] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: zhfaxbge
2025-12-01 17:35:07.486 [http-nio-8080-exec-10] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: zhfaxbge (Total active: 1)
2025-12-01 17:35:07.486 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:35:07.486 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 17:35:07.487 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:35:07.487 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764606801943-0, fields={type=order.created, order_id=9880, amount=22.85}}, {id=1764606801840-0, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}}, {id=1764606801740-0, fields={type=order.created, order_id=3104, amount=97.57}}, {id=1764606801656-0, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}}], streamName=test-stream}]
2025-12-01 17:35:07.488 [http-nio-8080-exec-9] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:35:07.488 [http-nio-8080-exec-9] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:07.489 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:35:07.489 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:16.261 [SockJS-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [asmi2c55]
2025-12-01 17:35:27.406 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zhfaxbge] closed with CloseStatus[code=1000, reason=null]
2025-12-01 17:35:27.409 [http-nio-8080-exec-3] INFO  c.r.p.w.DLQEventWebSocketHandler - WebSocket connection closed: zhfaxbge (Status: CloseStatus[code=1000, reason=null])
2025-12-01 17:35:27.410 [http-nio-8080-exec-3] INFO  c.r.p.service.WebSocketEventService - WebSocket session removed: zhfaxbge (Sent 0 messages, Remaining active: 0)
2025-12-01 17:35:27.575 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream:dlq&count=10", parameters={masked}
2025-12-01 17:35:27.575 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/dlq/messages?streamName=test-stream&count=10", parameters={masked}
2025-12-01 17:35:27.575 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/info?t=1764606927570", parameters={masked}
2025-12-01 17:35:27.577 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:35:27.577 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:35:27.577 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#getMessages(String, int)
2025-12-01 17:35:27.578 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/info?t=1764606927570
2025-12-01 17:35:27.579 [http-nio-8080-exec-1] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:27.581 [http-nio-8080-exec-6] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream:dlq
2025-12-01 17:35:27.581 [http-nio-8080-exec-2] DEBUG c.r.p.controller.DLQController - Reading 10 messages from stream: test-stream
2025-12-01 17:35:27.582 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream:dlq'
2025-12-01 17:35:27.582 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Reading 10 messages from stream 'test-stream'
2025-12-01 17:35:27.583 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - GET "/api/ws/dlq-events/356/u1mf1gas/websocket", parameters={}
2025-12-01 17:35:27.584 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@d919544
2025-12-01 17:35:27.584 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/api/ws/dlq-events/356/u1mf1gas/websocket
2025-12-01 17:35:27.585 [http-nio-8080-exec-2] DEBUG c.r.p.service.DLQMessagingService - Read 4 messages from stream 'test-stream'
2025-12-01 17:35:27.585 [http-nio-8080-exec-6] DEBUG c.r.p.service.DLQMessagingService - Read 0 messages from stream 'test-stream:dlq'
2025-12-01 17:35:27.586 [http-nio-8080-exec-4] DEBUG o.s.web.servlet.DispatcherServlet - Completed 101 SWITCHING_PROTOCOLS
2025-12-01 17:35:27.586 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:35:27.586 [http-nio-8080-exec-6] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:35:27.587 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=0, messages=[], streamName=test-stream:dlq}]
2025-12-01 17:35:27.587 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, count=4, messages=[{id=1764606801943-0, fields={type=order.created, order_id=9880, amount=22.85}}, {id=1764606801840-0, fields={type=order.cancelled, order_id=6956, reason=fraud_detected}}, {id=1764606801740-0, fields={type=order.created, order_id=3104, amount=97.57}}, {id=1764606801656-0, fields={type=order.cancelled, order_id=9503, reason=out_of_stock}}], streamName=test-stream}]
2025-12-01 17:35:27.588 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=u1mf1gas]
2025-12-01 17:35:27.588 [http-nio-8080-exec-4] INFO  c.r.p.w.DLQEventWebSocketHandler - New WebSocket connection established: u1mf1gas
2025-12-01 17:35:27.588 [http-nio-8080-exec-4] INFO  c.r.p.service.WebSocketEventService - WebSocket session registered: u1mf1gas (Total active: 1)
2025-12-01 17:35:27.590 [http-nio-8080-exec-2] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:35:27.591 [http-nio-8080-exec-6] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:35:27.592 [http-nio-8080-exec-2] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:27.594 [http-nio-8080-exec-6] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
2025-12-01 17:35:36.258 [SockJS-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [zhfaxbge]
2025-12-01 17:37:06.840 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - POST "/api/dlq/process", parameters={}
2025-12-01 17:37:06.846 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerMapping - Mapped to com.redis.patterns.controller.DLQController#processMessage(Map)
2025-12-01 17:37:06.849 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestResponseBodyMethodProcessor - Read "application/json;charset=UTF-8" to [{shouldSucceed=true}]
2025-12-01 17:37:06.850 [http-nio-8080-exec-7] INFO  c.r.p.controller.DLQController - Processing message with shouldSucceed=true
2025-12-01 17:37:06.850 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing next message with shouldSucceed=true
2025-12-01 17:37:06.850 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Ensuring consumer groups are initialized
2025-12-01 17:37:06.850 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group' for stream 'test-stream'
2025-12-01 17:37:06.853 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group' already exists
2025-12-01 17:37:06.853 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Initializing consumer group 'test-group-dlq' for stream 'test-stream:dlq'
2025-12-01 17:37:06.854 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Consumer group 'test-group-dlq' already exists
2025-12-01 17:37:06.854 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Getting next 1 messages from stream 'test-stream'
2025-12-01 17:37:06.854 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Executing claim_or_dlq with params: DLQParameters(streamName=test-stream, dlqStreamName=test-stream:dlq, consumerGroup=test-group, consumerName=consumer-1, minIdleMs=100, count=100, maxDeliveries=2)
2025-12-01 17:37:06.856 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - claim_or_dlq completed: 0 messages reclaimed, 0 sent to DLQ
2025-12-01 17:37:06.856 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Need 1 more messages, reading new messages
2025-12-01 17:37:06.857 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Added new message: Message[id=1764606801943-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9880, amount=22.85}]
2025-12-01 17:37:06.857 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: INFO
2025-12-01 17:37:06.858 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Returning 1 messages (0 retries, 1 new)
2025-12-01 17:37:06.858 [http-nio-8080-exec-7] INFO  c.r.p.service.DLQMessagingService - Processing message: Message[id=1764606801943-0, deliveryCount=1, retry=false, fields={type=order.created, order_id=9880, amount=22.85}]
2025-12-01 17:37:06.858 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_PROCESSED
2025-12-01 17:37:06.962 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Acknowledging message 1764606801943-0 in stream 'test-stream'
2025-12-01 17:37:06.964 [http-nio-8080-exec-7] DEBUG c.r.p.service.WebSocketEventService - Broadcasting event to 1 sessions: MESSAGE_DELETED
2025-12-01 17:37:06.964 [http-nio-8080-exec-7] DEBUG c.r.p.service.DLQMessagingService - Message 1764606801943-0 acknowledged successfully
2025-12-01 17:37:06.965 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.m.a.HttpEntityMethodProcessor - Using 'application/json', given [application/json, text/plain, */*] and supported [application/json, application/*+json]
2025-12-01 17:37:06.966 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.HttpEntityMethodProcessor - Writing [{success=true, wasRetry=false, messageId=1764606801943-0, message=âœ“ Message 1764606801943-0 processed successfully (deliveryCount: 1), deliveryCount=1}]
2025-12-01 17:37:06.968 [http-nio-8080-exec-7] TRACE o.s.w.s.m.m.a.RequestMappingHandlerAdapter - Applying default cacheSeconds=-1
2025-12-01 17:37:06.968 [http-nio-8080-exec-7] DEBUG o.s.web.servlet.DispatcherServlet - Completed 200 OK
