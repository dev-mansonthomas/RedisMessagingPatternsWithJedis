import{a as k,b as N,c as W,d as V,h as j}from"./chunk-IRGIIFUN.js";import{$a as z,Eb as w,Fb as E,Gb as h,Ja as g,Mb as T,Na as b,R as m,Ua as c,Va as t,W as C,Wa as e,X as v,Xa as f,a as F,ab as P,b as I,bb as x,fb as M,ga as l,gb as o,hb as _,ib as u,kb as y,lb as S,mb as O,wa as a}from"./chunk-ZMHPBY6C.js";function U(r,p){if(r&1){let n=z();t(0,"div",12)(1,"input",13),O("ngModelChange",function(s){let d=C(n).$implicit;return S(d.key,s)||(d.key=s),v(s)}),e(),t(2,"input",14),O("ngModelChange",function(s){let d=C(n).$implicit;return S(d.value,s)||(d.value=s),v(s)}),e(),t(3,"button",15),P("click",function(){let s=C(n).index,d=x();return v(d.removeField(s))}),o(4," \u2715 "),e()()}if(r&2){let n=p.$implicit,i=x();a(),y("ngModel",n.key),a(),y("ngModel",n.value),a(),c("disabled",i.fields().length===1)}}function H(r,p){if(r&1&&(t(0,"div",16),o(1),e()),r&2){let n=x();M("success",n.isSuccess())("error",!n.isSuccess()),a(),u(" ",n.message()," ")}}var B=(()=>{class r{constructor(){this.http=m(T),this.apiUrl="http://localhost:8080/api/pubsub",this.channel="fire-and-forget",this.fields=l([{key:"type",value:"order"},{key:"id",value:"12345"},{key:"status",value:"created"}]),this.isPublishing=l(!1),this.message=l(""),this.isSuccess=l(!1)}addField(){this.fields.update(n=>[...n,{key:"",value:""}])}removeField(n){this.fields.update(i=>i.filter((s,d)=>d!==n))}publishMessage(){this.isPublishing.set(!0),this.message.set("");let n={};this.fields().forEach(i=>{i.key&&i.value&&(n[i.key]=i.value)}),this.http.post(`${this.apiUrl}/publish`,{channel:this.channel,payload:n}).subscribe({next:i=>{this.isSuccess.set(!0),this.message.set(`\u2705 Published to ${i.subscriberCount} subscribers`),this.isPublishing.set(!1),this.updateFieldsForNextMessage(),setTimeout(()=>this.message.set(""),3e3)},error:i=>{this.isSuccess.set(!1),this.message.set(`\u274C Error: ${i.error?.error||i.message}`),this.isPublishing.set(!1)}})}updateFieldsForNextMessage(){let n=["created","cancelled","updated"];this.fields.update(i=>i.map(s=>{if(s.key==="id"){let d=parseInt(s.value,10);if(!isNaN(d))return I(F({},s),{value:(d+1).toString()})}if(s.key==="status"){let d=n[Math.floor(Math.random()*n.length)];return I(F({},s),{value:d})}return s}))}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-pubsub-producer"]],decls:19,vars:5,consts:[[1,"producer-container"],[1,"producer-header"],[1,"producer-title"],[1,"producer-content"],[1,"form-group"],["for","channel"],["id","channel","type","text","placeholder","fire-and-forget",1,"form-input",3,"ngModelChange","ngModel"],[1,"payload-fields"],["class","field-row",4,"ngFor","ngForOf"],[1,"btn-add",3,"click"],[1,"btn-publish",3,"click","disabled"],["class","message",3,"success","error",4,"ngIf"],[1,"field-row"],["type","text","placeholder","Key",1,"form-input","field-key",3,"ngModelChange","ngModel"],["type","text","placeholder","Value",1,"form-input","field-value",3,"ngModelChange","ngModel"],[1,"btn-remove",3,"click","disabled"],[1,"message"]],template:function(i,s){i&1&&(t(0,"div",0)(1,"div",1)(2,"h3",2),o(3,"\u{1F4E4} Producer"),e()(),t(4,"div",3)(5,"div",4)(6,"label",5),o(7,"Channel"),e(),t(8,"input",6),O("ngModelChange",function(D){return S(s.channel,D)||(s.channel=D),D}),e()(),t(9,"div",4)(10,"label"),o(11,"Message Payload"),e(),t(12,"div",7),b(13,U,5,3,"div",8),e(),t(14,"button",9),P("click",function(){return s.addField()}),o(15,"+ Add Field"),e()(),t(16,"button",10),P("click",function(){return s.publishMessage()}),o(17),e(),b(18,H,2,5,"div",11),e()()),i&2&&(a(8),y("ngModel",s.channel),a(5),c("ngForOf",s.fields()),a(3),c("disabled",s.isPublishing()),a(),u(" ",s.isPublishing()?"Publishing...":"\u{1F680} Publish Message"," "),a(),c("ngIf",s.message()))},dependencies:[h,w,E,j,N,W,V],styles:[".producer-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;border:1px solid #e2e8f0;border-radius:8px;overflow:hidden}.producer-header[_ngcontent-%COMP%]{padding:16px;background:linear-gradient(135deg,#f093fb,#f5576c);color:#fff}.producer-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0}.producer-content[_ngcontent-%COMP%]{flex:1;padding:16px;overflow-y:auto}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#475569;margin-bottom:6px}.form-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #cbd5e1;border-radius:6px;font-size:14px;transition:all .2s ease}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.payload-fields[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:8px}.field-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr auto;gap:8px;align-items:center}.field-key[_ngcontent-%COMP%], .field-value[_ngcontent-%COMP%]{width:100%}.btn-remove[_ngcontent-%COMP%]{padding:8px 12px;background:#fee2e2;color:#dc2626;border:1px solid #fca5a5;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s ease}.btn-remove[_ngcontent-%COMP%]:hover:not(:disabled){background:#fca5a5;color:#fff}.btn-remove[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-add[_ngcontent-%COMP%]{width:100%;padding:8px;background:#f1f5f9;color:#475569;border:1px dashed #cbd5e1;border-radius:6px;cursor:pointer;font-size:14px;transition:all .2s ease}.btn-add[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8}.btn-publish[_ngcontent-%COMP%]{width:100%;padding:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:6px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-publish[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #667eea66}.btn-publish[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.message[_ngcontent-%COMP%]{margin-top:12px;padding:12px;border-radius:6px;font-size:14px}.message.success[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46;border:1px solid #6ee7b7}.message.error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;border:1px solid #fca5a5}"]})}}return r})();function $(r,p){r&1&&(t(0,"div",10)(1,"div",11),o(2,"\u{1F4ED}"),e(),t(3,"p",12),o(4,"No messages received yet"),e(),t(5,"p",13),o(6,"Waiting for published messages..."),e()())}function G(r,p){if(r&1&&(t(0,"div",20)(1,"span",21),o(2),e(),t(3,"span",22),o(4),e()()),r&2){let n=p.$implicit;a(2),u("",n.key,":"),a(2),_(n.value)}}function K(r,p){if(r&1&&(t(0,"div",14)(1,"div",15)(2,"span",16),o(3),e(),t(4,"span",17),o(5),e()(),t(6,"div",18),b(7,G,5,2,"div",19),e()()),r&2){let n=p.$implicit,i=x();a(3),_(n.channel),a(2),_(i.formatTime(n.timestamp)),a(2),c("ngForOf",i.getFields(n.payload))}}var L=(()=>{class r{constructor(){this.title="Subscriber",this.channel="fire-and-forget",this.wsService=m(k),this.messages=l([]),this.isConnected=l(!1)}ngOnInit(){this.subscription=this.wsService.getEvents().subscribe(n=>{n.eventType==="MESSAGE_RECEIVED"&&n.channel===this.channel&&this.messages.update(i=>[{channel:n.channel,payload:n.payload,timestamp:n.timestamp},...i].slice(0,50))}),this.connectionSubscription=this.wsService.getConnectionStatus().subscribe(n=>{this.isConnected.set(n)}),this.isConnected.set(this.wsService.isConnected())}ngOnDestroy(){this.subscription?.unsubscribe(),this.connectionSubscription?.unsubscribe()}getFields(n){return Object.entries(n).map(([i,s])=>({key:i,value:s}))}formatTime(n){return new Date(n).toLocaleTimeString()}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-pubsub-subscriber"]],inputs:{title:"title",channel:"channel"},decls:13,vars:9,consts:[[1,"subscriber-container"],[1,"subscriber-header"],[1,"header-left"],[1,"subscriber-title"],[1,"connection-status"],[1,"status-dot"],[1,"message-count"],[1,"messages-container"],["class","empty-state",4,"ngIf"],["class","message-card",4,"ngFor","ngForOf"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-text"],[1,"empty-hint"],[1,"message-card"],[1,"message-header"],[1,"message-channel"],[1,"message-time"],[1,"message-payload"],["class","payload-field",4,"ngFor","ngForOf"],[1,"payload-field"],[1,"field-key"],[1,"field-value"]],template:function(i,s){i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o(4),e(),t(5,"span",4),f(6,"span",5),o(7),e()(),t(8,"span",6),o(9),e()(),t(10,"div",7),b(11,$,7,0,"div",8)(12,K,8,3,"div",9),e()()),i&2&&(a(4),_(s.title),a(),M("connected",s.isConnected())("disconnected",!s.isConnected()),a(2),u(" ",s.isConnected()?"WS Connected":"WS Disconnected"," "),a(2),u("",s.messages().length," messages"),a(2),c("ngIf",s.messages().length===0),a(),c("ngForOf",s.messages()))},dependencies:[h,w,E],styles:[".subscriber-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background:#fff;border:1px solid #e2e8f0;border-radius:8px;overflow:hidden}.subscriber-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.header-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.subscriber-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0}.connection-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:12px;font-weight:500;padding:3px 8px;border-radius:10px;background:#ffffff26;width:fit-content}.connection-status.connected[_ngcontent-%COMP%]{background:#22c55e33}.connection-status.disconnected[_ngcontent-%COMP%]{background:#ef444433}.status-dot[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%;background:#fff}.connection-status.connected[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:#22c55e;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.connection-status.disconnected[_ngcontent-%COMP%]   .status-dot[_ngcontent-%COMP%]{background:#ef4444}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.message-count[_ngcontent-%COMP%]{font-size:14px;background:#fff3;padding:4px 12px;border-radius:12px}.messages-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:12px;max-height:275px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#94a3b8}.empty-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px}.empty-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin:0 0 8px}.empty-hint[_ngcontent-%COMP%]{font-size:14px;margin:0}.message-card[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:6px;padding:12px;margin-bottom:8px;transition:all .2s ease}.message-card[_ngcontent-%COMP%]:hover{border-color:#cbd5e1;box-shadow:0 2px 4px #0000000d}.message-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.message-channel[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#667eea}.message-time[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.message-payload[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.payload-field[_ngcontent-%COMP%]{font-size:13px;font-family:Monaco,Menlo,monospace}.field-key[_ngcontent-%COMP%]{color:#475569;font-weight:500}.field-value[_ngcontent-%COMP%]{color:#1e293b;margin-left:8px}"]})}}return r})();var ge=(()=>{class r{constructor(){this.wsService=m(k)}ngOnInit(){this.wsService.connect()}static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-pubsub"]],decls:57,vars:0,consts:[[1,"pubsub-container"],[1,"page-header"],[1,"page-title"],[1,"page-description"],[1,"content-layout"],[1,"producer-column"],[1,"icon-column"],[1,"icon-container"],["src","assets/img/icon-streams-64-duotone.png","alt","Redis",1,"redis-icon"],[1,"icon-label"],[1,"icon-description"],[1,"subscribers-column"],["title","Subscriber 1","channel","fire-and-forget"],["title","Subscriber 2","channel","fire-and-forget"],[1,"explanation-section"],[1,"explanation-title"],[1,"explanation-content"],[1,"explanation-block"],[1,"block-title"],[1,"block-code"],[1,"code-line"],[1,"function"],[1,"code-line","comment"]],template:function(i,s){i&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Publish/Subscribe (Pub/Sub)"),e(),t(4,"p",3),o(5," Demonstrate Redis Pub/Sub pattern with fire-and-forget messaging and real-time broadcasting to multiple subscribers. "),e()(),t(6,"div",4)(7,"div",5),f(8,"app-pubsub-producer"),e(),t(9,"div",6)(10,"div",7),f(11,"img",8),t(12,"div",9),o(13,"Redis Pub/Sub"),e(),t(14,"div",10),o(15,"Fire & Forget"),e()()(),t(16,"div",11),f(17,"app-pubsub-subscriber",12)(18,"app-pubsub-subscriber",13),e()(),t(19,"div",14)(20,"h3",15),o(21,"\u{1F525} Pub/Sub Pattern (Fire & Forget)"),e(),t(22,"div",16)(23,"div",17)(24,"div",18),o(25,"\u{1F4E4} Publisher"),e(),t(26,"div",19)(27,"div",20)(28,"span",21),o(29,"PUBLISH"),e(),o(30,"(channel, message)"),e(),t(31,"div",22),o(32,"// Fire & forget - no delivery guarantee"),e()()(),t(33,"div",17)(34,"div",18),o(35,"\u{1F504} Redis Pub/Sub"),e(),t(36,"div",19)(37,"div",20),o(38,"\u2705 Ephemeral (no persistence)"),e(),t(39,"div",20),o(40,"\u2705 Instant broadcast to all subscribers"),e(),t(41,"div",20),o(42,"\u274C No delivery guarantee"),e(),t(43,"div",20),o(44,"\u274C Lost if no subscribers listening"),e()()(),t(45,"div",17)(46,"div",18),o(47,"\u{1F4E5} Subscribers"),e(),t(48,"div",19)(49,"div",20)(50,"span",21),o(51,"SUBSCRIBE"),e(),o(52,"(channel)"),e(),t(53,"div",22),o(54,"// All subscribers receive same message"),e(),t(55,"div",22),o(56,"// Real-time, simultaneous delivery"),e()()()()()())},dependencies:[h,B,L],styles:[".pubsub-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:20px}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b;margin:0 0 8px}.page-description[_ngcontent-%COMP%]{font-size:16px;color:#64748b;margin:0;line-height:1.6}.content-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto 1fr;gap:24px;min-height:600px;margin-bottom:24px}.producer-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.icon-column[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:0 16px}.icon-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px}.redis-icon[_ngcontent-%COMP%]{width:64px;height:64px;opacity:.8}.icon-label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#475569;text-align:center}.icon-description[_ngcontent-%COMP%]{font-size:12px;color:#94a3b8;text-align:center}.subscribers-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.explanation-section[_ngcontent-%COMP%]{padding:20px;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border:1px solid #cbd5e1;border-radius:8px;box-shadow:0 2px 4px #0000000d}.explanation-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1e293b;margin:0 0 16px}.explanation-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}.explanation-block[_ngcontent-%COMP%]{background:#fff;padding:16px;border-radius:6px;border:1px solid #e2e8f0}.block-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#475569;margin-bottom:12px}.block-code[_ngcontent-%COMP%]{font-family:Monaco,Menlo,monospace;font-size:13px;line-height:1.6}.code-line[_ngcontent-%COMP%]{margin:4px 0}.function[_ngcontent-%COMP%]{color:#0891b2;font-weight:600}.comment[_ngcontent-%COMP%]{color:#64748b;font-style:italic}@media(max-width:1024px){.content-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.icon-column[_ngcontent-%COMP%]{display:none}.explanation-content[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return r})();export{ge as PubsubComponent};
